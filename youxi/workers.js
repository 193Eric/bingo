
	define("workers/games_exports.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";var e={_logs:[],getWorkerLog:function(){if(this._logs&&0!=this._logs.length){var e=this._logs;return this._logs=[],e}return null},_joinLog:function(e){for(var t=e[0],r=1;r<e.length;r++)t+=", "+e[r];return t},log:function(){var e=Array.prototype.slice.call(arguments);e="[log] "+this._joinLog(e);this._logs.push(e)},error:function(){var e=Array.prototype.slice.call(arguments);e="[error] "+this._joinLog(e);this._logs.push(e)},warn:function(){var e=Array.prototype.slice.call(arguments);e="[warn] "+this._joinLog(e);this._logs.push(e)},assert:function(e,t){0!==e&&""!==e&&(e||this.warn(""+(t?"\u65ad\u8a00\u63d0\u793a\uff1a"+t+" "+Error().stack:Error().stack)))},isWorkerWorking:function(){return!0}},t={init:function(e,t){for(var r=[],n=0;n<t;n++)r[n]=e;return r},copy:function(e){return e.concat()},deepCopy:function(e){return deepClone(e)},addObject:function(e,t){return e.push(t),e},addObjects:function(e,t){for(var r=0;r<t.length;r++)e.push(t[r]);return e},insertObject:function(e,t){return e.unshift(t),e},insertObjects:function(t,r){e.assert(Array.isArray(t),"ddzh-DDZHArrayEx-insertObjects-array\u5fc5\u987b\u662f\u6570\u7ec4"),e.assert(Array.isArray(r),"ddzh-DDZHArrayEx-insertObjects-objs\u5fc5\u987b\u662f\u6570\u7ec4");for(var n=r.length-1;0<=n;n--)t.unshift(r[n]);return t},insertObjectAtIndex:function(e,t,r){return e.splice(t,0,r),e},insertObjectsAtIndex:function(e,t,r){return e.splice(t,0,r),e},insertObjectsAtIndexs:function(t,r,n){e.assert(n.length==r.length,"ddzh-DDZHArrayEx-insertObjectsAtIndexs-\u957f\u5ea6\u4e0d\u7b49");for(var a=0;a<r.length;a++)this.insertObjectAtIndex(t,r[a]+a,n[a]);return t},find:function(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return e[r]},notEmpty:function(e){var t=[];return e.map((function(e,r){""!==e&&null!=e&&null!=e&&t.push(e)})),t},hasEmpty:function(e){for(var t=0;t<e.length;t++)if(null==e[t])return!0;return!1},findIndex:function(e,t){for(var r=0;r<e.length;r++)if(e[r]==t)return r},indexOf:function(e,t,r){for(var n=0;n<e.length;n++)if(e[n][t]==r)return n;return-1},findSetByCondition:function(e,t){for(var r=[],n=0;n<e.length;n++)t(e[n])&&r.push(e[n]);return r},removeObject:function(e,t){return this.removeObjectByCondition(e,(function(e){return e==t}))},removeObjectByCondition:function(e,t){for(var r in e)if(t(e[r])){for(;r<e.length-1;r++){var n=parseInt(r)+1;e[r]=e[n]}e.pop();break}return e},removeAllObject:function(e,t){return this.removeAllObjectByCondition(e,(function(e){return e==t}))},removeAllObjectByCondition:function(e,t){for(var r=e.length-1;0<=r;r--)t(e[r])&&e.splice(r,1);return e},removeLastObject:function(e){return e.pop(),e},removeFirstObject:function(e){return e.shift(),e},isValueExist:function(e,t){for(var r in e)if(e[r]==t)return!0;return!1},concat:function(e,t){return e.join(t)},append:function(e,t){return e.concat(t)},unpack:function(e){for(var t=[],r=0;r<e.length;r++)for(var n=e[r],a=0;a<n.length;a++)t.push(n[a]);return t},reverse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n]=e[t-n-1];return r},sort:function(e){return e.sort((function(e,t){return e<t?-1:e>t?1:0}))},sortReverse:function(e){return e.sort((function(e,t){return e<t?1:e>t?-1:0}))},sortByCondition:function(e,r){var n=e.length;if(2>n)return e;for(var a=[];0<n;){var i=e[i=this._findKey(e,r)];a.push(i),t.removeObject(e,i),--n}for(n=0;n<a.length;n++)e[n]=a[n];return e},classify:function(e,t){for(var r=[],n=[],a=0;a<e.length;a++){var i=e[a];t(i)?r.push(i):n.push(i)}for(a=0;a<r.length;a++)e[a]=r[a];for(r=r.length,a=0;a<n.length;a++)e[a+r]=n[a]},classifyToArray:function(e,t){for(var r={},n=0;n<e.length;n++){var a=e[n],i=t(a),u=r[i]||[];u.push(a),r[i]=u}for(i in n=[],r)n.push(r[i]);return n},_findKey:function(e,t){var r=e.length;if(1==e.length)return 0;for(var n=0,a=e[n],i=1;i<r;i++)t(a,e[i])||(a=e[n=i]);return n},unique:function(e){for(var t=[],r=0,n=e.length;r<n;r++){var a=e[r];-1===t.indexOf(a)&&t.push(a)}return t},jointly:function(e,t){return e.filter((function(e){return-1<t.indexOf(e)}))}},r={Invalid:0,Rear:255,Fang_1:1,Fang_2:2,Fang_3:3,Fang_4:4,Fang_5:5,Fang_6:6,Fang_7:7,Fang_8:8,Fang_9:9,Fang_10:10,Fang_J:11,Fang_Q:12,Fang_K:13,Mei_1:17,Mei_2:18,Mei_3:19,Mei_4:20,Mei_5:21,Mei_6:22,Mei_7:23,Mei_8:24,Mei_9:25,Mei_10:26,Mei_J:27,Mei_Q:28,Mei_K:29,Hong_1:33,Hong_2:34,Hong_3:35,Hong_4:36,Hong_5:37,Hong_6:38,Hong_7:39,Hong_8:40,Hong_9:41,Hong_10:42,Hong_J:43,Hong_Q:44,Hong_K:45,Hei_1:49,Hei_2:50,Hei_3:51,Hei_4:52,Hei_5:53,Hei_6:54,Hei_7:55,Hei_8:56,Hei_9:57,Hei_10:58,Hei_J:59,Hei_Q:60,Hei_K:61,King_1:65,King_2:66},n={Fang:0,Mei:1,Hong:2,Hei:3,King:4,Invalid:5},a={CT_ERROR:0,CT_SINGLE:1,CT_DOUBLE:2,CT_SINGLE_CONNECT:3,CT_DOUBLE_CONNECT:4,CT_CHA:5,CT_THREE_LINE_TAKE_ONE:6,CT_THREE_LINE_TAKE_TWO:7,CT_FOUR_LINE_TAKE_TWO:8,CT_FOUR_LINE_TAKE_ONE:9,CT_AIRCRAFT:10,CT_AIRCRAFT_ONE:11,CT_AIRCRAFT_TWO:12,CT_BOMB_THREE:13,CT_BOMB_FOUR_RL:14,CT_BOMB_FOUR:15,CT_BOMB_FOUR_L:16,CT_BOMB_FIVE_RL:17,CT_BOMB_FIVE_L:18,CT_BOMB_SIX_RL:19,CT_BOMB_SIX_L:20,CT_BOMB_SEVEN_RL:21,CT_BOMB_SEVEN_L:22,CT_BOMB_EIGHT_RL:23,CT_BOMB_EIGHT_L:24,CT_BOMB_NINE_RL:25,CT_BOMB_TEN_RL:26,CT_BOMB_ELEVEN_RL:27,CT_BOMB_TWELVE_RL:28,CT_TWOKING:29,CT_BOMB_LINE_TWO:30,CT_BOMB_LINE_THREE:31,CT_BOMB_LINE_FOUR:32,CT_BOMB_LINE_FIVE:33},i={isValidCard:function(e){return PKCardKit.isValidCard(e)},getCardPoint:function(e){return PKCardKit.getCardPoint(e)},getCardColor:function(e){return PKCardKit.getCardColor(e)},tagCard:function(e){var t={cardSerial:e=e||0,cardValue:e%16,cardShowNum:e%16,cardType:Math.floor(e/16)};if(null!=this.TagCardSortFun)return this.TagCardSortFun(t);if(this.getRule){var r=this.getRule();if(null!=r)return this.initByRule(e,r)}return t.cardValueSuper=t.cardValue,3>=t.cardType?1!=t.cardValue&&2!=t.cardValue||(t.cardValueSuper=t.cardValue+13):(t.cardValueSuper=t.cardValue+15,t.cardShowNum+=13),t.cardOrderId=10*t.cardValueSuper+t.cardType,t},initByRule:function(e,t){var r={cardSerial:e=e||0,cardValue:e%16,cardShowNum:e%16,cardType:Math.floor(e/16)};return r.cardValueSuper=r.cardValue,r.cardType<n.King&&t[r.cardValue]&&(r.cardValueSuper=t[r.cardValue]),r.cardOrderId=10*r.cardValueSuper+r.cardType,r},tagLZOutCard:function(e,t,r,n,a,i){return{OutCardType:e||0,OutCardCount:t||0,MaxOutCard:r||0,vNotLZCard:n||[],vLZCard:a||[],vLZReplaceCard:i||[]}},setTagCardSortFun:function(e){console.warn("DDZHTools.setTagCardSortFun \u8be5\u65b9\u6cd5\u7981\u6b62\u8c03\u7528\uff0c\u4f1a\u6c61\u67d3\u5168\u5c40\u53d8\u91cf"),this.TagCardSortFun=e||void 0},setRule:function(e){this.mSortRuleTab=e||void 0},getRule:function(){return this.mSortRuleTab},clearRule:function(){this.TagCardSortFun=this.mSortRuleTab=void 0}},u={getCardsData:function(t){if(e.assert(Array.isArray(t),"ddzh-DDZHRule-getCardsData-cardsSerial\u5fc5\u987b\u662f\u6570\u7ec4"),"number"!=typeof t[0])return t;for(var r=[],n=0;n<t.length;n++)r.push(i.tagCard(t[n]));return this.sortCardsData(r)},getCardsSerial:function(t){if(e.assert(Array.isArray(t),"ddzh-DDZHRule-getCardsSerial-cardsData\u5fc5\u987b\u662f\u6570\u7ec4"),"number"==typeof t[0])return t;for(var r=[],n=0;n<t.length;n++)r.push(t[n].cardSerial);return r},sortCardsData:function(e){return e.sort((function(e,t){return e.cardValueSuper-t.cardValueSuper})),e},sortDDZHCards:function(e){return e.sort((function(e,t){var r=i.tagCard(e);return i.tagCard(t).cardOrderId-r.cardOrderId})),e},splitCardsData:function(e){var t=this.getCardsData(e);t=this.sortCardsData(t);e=[];for(var r=[],n=0;n<t.length;n++){var a=t[n],i=a.cardValueSuper;e[i]?e[i].push(a):e[i]=[a]}for(i in e)(t={})[i]=e[i],r.push(t);return r},getSortAndDelete:function(e,t,r,n){n=i.tagCard(n).cardValueSuper;for(var a=[],u=0;u<e.length;u++){var l,g=e[u];for(l in g){var h=g[l];h.length>=t&&h.length<=r&&h[0].cardValueSuper>n&&(h=h.slice(0,t),a.push(h))}}return a},additionalData:function(e,t,r,n,a,i,u,l){null==n&&(n=1),i=null==i||i;var g=[],h=[];g.isFront=!1,g.curCards=h;var s=r*n;if(s>t.length)return g;for(var o=0;o<e.length;o++){for(var d=e[o],c=t.concat(),f=0;f<d.length;f++)this._removeByValue(c,"cardValueSuper",d[f].cardValueSuper,!0);var C=c.concat(),_=this.splitCardsData(c),p=this.getBombTab(_,null,u,l);for(f=0;f<p.length;f++)for(var O=p[f],T=0;T<O.length;T++)this._removeByValue(c,"cardValueSuper",O[T].cardValueSuper,!0);if(f=[],2==n&&(_=this.splitCardsData(c),f=this.getSortAndDelete(_,n,4)),s>c.length||2==n&&r>f.length)c=C,0<(d=this._addCardData(d,c,r,n,i)).length&&h.push(d),g.isFront=!0;else{if(C=c.concat(),null!=a&&s>=a)for(p=d[0].cardValueSuper-1,O=d[d.length-1].cardValueSuper+1,_=this.getSortAndDelete(_,a,a),f=0;f<_.length;f++)(T=_[f][0].cardValueSuper)>=p&&T<=O&&this._removeByValue(c,"cardValueSuper",T,!0);if(f=[],2==n&&(_=this.splitCardsData(c),f=this.getSortAndDelete(_,n,4)),s>c.length||2==n&&r>f.length)c=C,0<(d=this._addCardData(d,c,r,n,pickMaxNum,i)).length&&h.push(d);else{for(C=c.concat(),_=this.getUnDragon(c,!0),p=this.splitCardsData(_),O=!1,f=0;f<p.length;f++)for(var S in p[f])if(p[f][S].length>=n){O=!0;break}O&&(c=_),f=[],2==n&&(_=this.splitCardsData(c),f=this.getSortAndDelete(_,n,4)),s>c.length||2==n&&r>f.length?(c=C,0<(d=this._addCardData(d,c,r,n,i)).length&&h.push(d)):s<=c.length&&(0<(d=this._addCardData(d,c,r,n,i)).length&&h.push(d))}}}return g.curCards=h,g},_addCardData:function(e,r,n,a,i){var u=[];(r=this.splitCardsData(r)).sort((function(e,t){var r,n=0,a=0;for(r in e)n=e[r].length;for(r in t)a=t[r].length;return n-a}));var l=[];if(1<a||1==a&&!i)l=this.getSortAndDelete(r,a,4);else for(i=0;i<r.length;i++)for(var g in r[i])l.push(r[i][g]);return(l=t.unpack(l)).length<n*a||(g=l.slice(0,n*a)).length>=n*a&&(u=e=e.concat(g)),u},getBombTab:function(e,t,n,a){null==t&&(t=0);var u=i.tagCard(t).cardValueSuper;t=[];for(var l=[],g=0;g<e.length;g++){var h,s=e[g];for(h in s)4==s[h].length&&s[h][0].cardValueSuper>u&&t.push(s[h]),1!=s[h].length||s[h][0].cardSerial!=r.King_1&&s[h][0].cardSerial!=r.King_2||l.push(s[h][0])}if(t.sort((function(e,t){return e[0].cardValueSuper-t[0].cardValueSuper})),2==l.length&&t.push(l),(n||a)&&0!=(e=this.getLineBomb(e,2,5)).length)for(h in e)t.push(e[h]);return t},getLineBomb:function(e,t,r,n){for(var a=[],i=t;i<=r;i++){var u;if(n=n&&i==t?n:0,u=this.getSortAndDelete(e,4,4,n),0<(u=this.getDragon(u,n,i)).length)for(var l in u)a.push(u[l])}return a},getKingBomb:function(e){for(var t=[],n=0;n<e.length;n++){var a,i=e[n];for(a in i){var u=i[a];1!=u.length||u[0].cardSerial!=r.King_1&&u[0].cardSerial!=r.King_2||t.push(u[0])}}return 2==t.length?t:null},getDragonMaxs:function(e,r){for(var n=this.getDragonMaxsWaitUnpack(e,r),a=[],i=0;i<n.length;i++)a.push(t.unpack(n[i]));return a},getDragon:function(e,r,n,a){if(r=i.tagCard(r).cardValueSuper,e=this.getDragonMaxsWaitUnpack(e,n),a&&e){for(n=[],a=0;a<e.length;a++){var u=e[a];n.push(t.unpack(u))}return 0<n.length&&n.sort((function(e,t){return t.length-e.length})),n}var l=[];for(a=0;a<e.length;a++){u=e[a];for(var g=0;g<u.length-n+1;g++){var h=u.concat().slice(g,n+g);h[h.length-1][0].cardValueSuper>r&&l.push(t.unpack(h))}}return l},getDragonMaxsWaitUnpack:function(e,t){e.sort((function(e,t){return e[0].cardValueSuper-t[0].cardValueSuper}));for(var r=[],n=[],a=0;a<e.length;a++){var i=e[a];if(0!=r.length&&e[a-1][0].cardValueSuper+1!=e[a][0].cardValueSuper&&(r.length>=t&&n.push(r),r=[]),r.push(i),a==e.length-1||14<=i[0].cardValueSuper){r.length>=t&&n.push(r);break}}return n},comparisonCardSerial:function(e,t){var r=i.tagCard(e),n=i.tagCard(t);return r.cardValueSuper==n.cardValueSuper?null:r.cardValueSuper>n.cardValueSuper},getMax:function(e){for(var t=null,r=0;r<e.length;r++){var n=e[r];0<n.cardValueSuper&&(t=n)}return t},_removeByValue:function(e,t,r,n){null==n&&(n=!1);for(var a=0;a<e.length;a++){var i=e[a];if(null!=i&&i[t]==r&&(e.splice(a,1),--a,!n))break}return e},getUnDragon:function(e,t){var r,n=[];for(r in e)if(t)n.push(e[r]);else for(var a in e[r])for(var i in e[r][a])n.push(e[r][a][i]);r=this.splitCardsData(n),a=this.getSortAndDelete(r,1,3),a=this.getDragonMaxs(a,5),r=this.getSortAndDelete(r,2,3);var l=this.getDragonMaxs(r,3);for(i=[],r=0;r<a.length;r++)i.push(u.getCardsSerial(a[r]));for(r=0;r<l.length;r++)i.push(u.getCardsSerial(l[r]));return n=u.getCardsSerial(n),this.removeObjectByObject(n,i[0])},removeObjectByObject:function(e,t){var r=[];return t&&e.forEach((function(e){-1===t.indexOf(e)&&r.push(e)})),r}},l={pkRuleTab:[],ddzhIsFourTake:!1,ddzhIsLianZha:!1,registerFunc:function(t,r){e.assert(t,"ddzh-DDZHRuleHelper-getCardsSerial-cardstype=undefined"),e.assert(r,"ddzh-DDZHRuleHelper-getCardsSerial-rule=undefined");var n=[];n.push(t),n.push(r),this.pkRuleTab.push(n)},clearRuleRegister:function(){this.pkRuleTab=[],this.ddzhIsLianZha=this.ddzhIsFourTake=!1},sortCardsValue:function(e){return e.sort((function(e,t){var r=i.tagCard(e);return i.tagCard(t).cardValueSuper-r.cardValueSuper})),e},getCardsInfo:function(t,r,n,a){e.assert(t,"ddzh-DDZHRuleHelper-getCardsInfo-cards=undefined"),t=u.getCardsSerial(t),null==r&&(r=0);var l=0;return(n=this.helpIsFit(t,void 0,n,a))&&(r=n[0],l=n[1]),i.tagLZOutCard(r,t.length,l,t,[],[])},helpIsFit:function(e,t,r,n){var a,i=null,u=function(e){if(e=g.isFit(e,r,n)){var t=[];return t.push(l),t.push(e),t}};for(a in this.pkRuleTab){var l=this.pkRuleTab[a][0],g=this.pkRuleTab[a][1];if(t){if(l==t){i=u(e);break}}else if(u(e)&&u(e)[0]){i=u(e);break}}return i},judgeMore:function(t,r,n,a){e.assert(t,"ddzh-DDZHRuleHelper-judgeMore-selectCards=undefined"),e.assert(r,"ddzh-DDZHRuleHelper-judgeMore-lastOutCardsData=undefined");var i=r.OutCardType,l=r.MaxOutCard;if(0==i)return 0!=this.getCardsInfo(t,null,n,a).OutCardType;if(14>i){var g=null;if((n=this.helpIsFit(t,i,n,a))&&(g=n[1]),null!=g&&u.comparisonCardSerial(g,l)&&r.OutCardCount==t.length)return!0;t=this.isFitBomb(t);var h;g=null;for(h in t)t.hasOwnProperty(h)&&(g=t[h]);if(null!=g)return!0}else{for(h in r=g=null,n=this.isFitBomb(t))n.hasOwnProperty(h)&&(g=n[h],r=h);if(r==i&&u.comparisonCardSerial(g,l)||r>i)return!0}return!1},isFitBomb:function(t){for(var r in e.assert(t,"ddzh-DDZHRuleHelper-isFitBomb-selectCards=undefined"),this.pkRuleTab){var n=this.pkRuleTab[r][0],a=this.pkRuleTab[r][1];if(14<=n){a=a.isFit(t);var i={};if(i[n]=a,null!=a)return i}}return null},getSmartSelectCards:function(t,r,n,a,i,u){return e.assert(t,"ddzh-DDZHRuleHelper-getSmartSelectCards-selectCards=undefined"),null==r&&(r=3),null==n&&(n=5),null==a&&(a=2),i=this.getCardsInfo(t,null,i,u),n=this.getOngDragonMaxs(t,n),r=this.getDoubleDragonMaxs(t,r),t=this.getThreeDragonMaxs(t,a),0!=i.OutCardType?null:null!=t&&null!=r&&null!=n?(a=t.length/3,i=r.length/2,u=n.length,a>=i&&a>=u?t:a<i&&i>=u?r:n):null!=t&&null!=r?t.length/3>=r.length/2?t:r:null!=r&&null!=n?r.length/2>=n.length?r:n:n||(r||(t||null))},getOngDragonMaxs:function(e,t){var r;return e=u.getCardsData(e),r=u.splitCardsData(e),r=u.getSortAndDelete(r,1,4),0==(r=u.getDragonMaxs(r,t)).length?null:r=u.getCardsSerial(r[0])},getDoubleDragonMaxs:function(e,t){var r;return e=u.getCardsData(e),r=u.splitCardsData(e),r=u.getSortAndDelete(r,2,4),0==(r=u.getDragonMaxs(r,t)).length?null:r=u.getCardsSerial(r[0])},getThreeDragonMaxs:function(e,t){var r;return e=u.getCardsData(e),r=u.splitCardsData(e),r=u.getSortAndDelete(r,3,4),0==(r=u.getDragonMaxs(r,t)).length?null:r=u.getCardsSerial(r[0])}},g={initRules:function(e){i.clearRule(),l.clearRuleRegister(),l.registerFunc(a.CT_SINGLE,m),l.registerFunc(a.CT_DOUBLE,C),l.registerFunc(a.CT_BOMB_THREE,z),l.registerFunc(a.CT_SINGLE_CONNECT,E),l.registerFunc(a.CT_DOUBLE_CONNECT,p),l.registerFunc(a.CT_THREE_LINE_TAKE_ONE,y),l.registerFunc(a.CT_THREE_LINE_TAKE_TWO,V),l.registerFunc(a.CT_AIRCRAFT,s),l.registerFunc(a.CT_AIRCRAFT_ONE,d),l.registerFunc(a.CT_AIRCRAFT_TWO,o),l.registerFunc(a.CT_BOMB_FOUR,f),l.ddzhIsFourTake=!1,l.ddzhIsLianZha=!1,e.isFourTake&&(l.ddzhIsFourTake=!0,l.registerFunc(a.CT_FOUR_LINE_TAKE_ONE,v),l.registerFunc(a.CT_FOUR_LINE_TAKE_TWO,T)),l.registerFunc(a.CT_TWOKING,D),e.isMingPai&&(l.ddzhIsLianZha=!0,l.registerFunc(a.CT_BOMB_LINE_TWO,A),l.registerFunc(a.CT_BOMB_LINE_THREE,B),l.registerFunc(a.CT_BOMB_LINE_FOUR,j),l.registerFunc(a.CT_BOMB_LINE_FIVE,b)),l.registerFunc(a.CT_ERROR,O)}},h={getOutCardArray:function(t){e.log("=============getOutCardArray============"),console.log(t.handCard);var r=t.lastOutCardInfo,n=t.isMingPaiRoom,l=t.isFriendLianZha,g=t.handCard.concat();t=r.MaxOutCard;var h=r.vNotLZCard,s=r.OutCardType,o=u.splitCardsData(g);if(s==a.CT_SINGLE_CONNECT||s==a.CT_DOUBLE_CONNECT||s==a.CT_AIRCRAFT_TWO||s==a.CT_AIRCRAFT_ONE||s==a.CT_AIRCRAFT){r=this._getChooseLength(s,h.length);var d=this._getAllCardArray(g,r,s)}r=[];var c=[];if(s==a.CT_SINGLE_CONNECT?r=this.getShunZiTipArray(d,t):s==a.CT_DOUBLE_CONNECT?r=this.getLianDuiTipArray(d,t):s==a.CT_THREE_LINE_TAKE_TWO?(r=r.concat(this._getAllOutCard(g,t,s)),r=(r=u.additionalData(r,u.getCardsData(g),1,2,null,null,n,l)).curCards):s==a.CT_THREE_LINE_TAKE_ONE?(r=r.concat(this._getAllOutCard(g,t,s)),r=(r=u.additionalData(r,u.getCardsData(g),1,1,null,null,n,l)).curCards):s==a.CT_AIRCRAFT_TWO?(r=this.getFeiJiTipArray(d,t),h=h.length/5,r=(r=u.additionalData(r,u.getCardsData(g),h,2,null,null,n,l)).curCards):s==a.CT_AIRCRAFT_ONE?(r=this.getFeiJiTipArray(d,t),h=h.length/4,r=(r=u.additionalData(r,u.getCardsData(g),h,1,null,null,n,l)).curCards):s==a.CT_AIRCRAFT?r=this.getFeiJiTipArray(d,t):14>s&&(r=r.concat(this._getAllOutCard(g,t,s))),14>s){if(t=[],s=[],(o=u.getBombTab(o.concat(),null,n,l)).length){for(g=0;g<o.length;g++)for(c=0;c<r.length;c++)for(h=r[c],d=0;d<h.length;d++)if(h[d].cardValueSuper==o[g][0].cardValueSuper){t.push(h),s.push(c);break}r=r.concat(o)}if((s=this._deleteEqual(s)).sort(),0<t.length){for(g=c=0;g<s.length;g++)r.splice(s[g]-c,1),c+=1;r=r.concat(t)}r=this._getCardsSerialTemp(r),c=this._getOutCardInfo(r,n,l)}else for(o=u.getBombTab(o.concat(),t,n,l),n=this._getOutCardInfo(this._getCardsSerialTemp(o),n,l),g=0;g<n.length;g++)l=i.tagCard(t).cardValueSuper,r=i.tagCard(n[g].MaxOutCard).cardValueSuper,(n[g].OutCardType>s||n[g].OutCardType==s&&r>l)&&c.push(n[g]);return c},getIsAutoTipCards:function(e,n,l,g){var h=n.vNotLZCard,s=n.OutCardType,o=this._getAllCardArray(e);if(h.length==e.length)return!0;if(l&&(14<i.tagCard(n.MaxOutCard).cardValueSuper||13<s)||!l&&s!=a.CT_SINGLE&&(14<i.tagCard(n.MaxOutCard).cardValueSuper||13<s))return!1;if(s==a.CT_SINGLE){if(h[0]==r.King_2&&!g)return!1;var d;for(g=!1,n=0;n<o.duizi.length;n++)if(l=o.duizi[n],d=0==this._removeObjectByObject(h.concat(),l).length,e=0==this._removeObjectByObject(h.concat(),t.unpack(o.sanzhang)).length,d&&!e&&(g=this._removeObjectByObject(l.concat(),t.unpack(o.longShunzi)).length<l.length),d&&g)return!0;if(d=0==this._removeObjectByObject(h.concat(),t.unpack(o.duizi)).length,e=0==this._removeObjectByObject(h.concat(),t.unpack(o.sanzhang)).length,g=this._removeObjectByObject(h.concat(),t.unpack(o.longShunzi)).length<h.length,!d&&!e&&!g)return!0;if(g){for(n=0;n<o.shunzi.length;n++)if(5>this._removeObjectByObject(o.shunzi[n],h.concat()).length&&2<(l=this._removeObjectByObject(o.shunzi[n],t.unpack(o.duizi))).length)return!1;return!0}}else if(s==a.CT_DOUBLE){if(e=this._removeObjectByObject(h.concat(),t.unpack(o.sanzhang)).length<h.length,g=this._removeObjectByObject(h.concat(),t.unpack(o.longShunzi)).length<h.length,d=this._removeObjectByObject(h.concat(),t.unpack(o.liandui)).length<h.length,g&&!e&&!d)for(n=0;n<o.longShunzi.length;n++){l=o.longShunzi[n];s=i.tagCard(h[0]).cardValueSuper;var c=i.tagCard(l[0]).cardValueSuper,f=i.tagCard(l[l.length-1]).cardValueSuper;if(5<l.length&&(s==c||s==f))return!0;if(l=o.longShunzi[n],this._removeObjectByObject(o.longShunzi[n],h.concat()).length<l.length)return!(2<(l=this._removeObjectByObject(l,t.unpack(o.duizi))).length)}if(!e&&!g&&!d)return!0}else if(s==a.CT_BOMB_THREE||s==a.CT_THREE_LINE_TAKE_ONE||s==a.CT_THREE_LINE_TAKE_TWO){if(l=u.splitCardsData(h.concat()),e=this._getCardsSerialTemp(u.getSortAndDelete(l,3,3)),e=t.unpack(e),d=this._removeObjectByObject(h.concat(),e.concat()),14<i.tagCard(d[0]).cardValueSuper)return!1;if(h=this._removeObjectByObject(d.concat(),t.unpack(o.longShunzi)).length<d.length,n=this._removeObjectByObject(d.concat(),t.unpack(o.sanzhang)).length<d.length,s=this._removeObjectByObject(d.concat(),t.unpack(o.liandui)).length<d.length,g=this._removeObjectByObject(e.concat(),t.unpack(o.longShunzi)).length<e.length,d=this._removeObjectByObject(e.concat(),t.unpack(o.liandui)).length<e.length,l=this._removeObjectByObject(e.concat(),t.unpack(o.feiji)).length<e.length,!(n||h||s||g||d||l))return!0;if(g&&!d&&!l){for(n=0;n<o.shunzi.length;n++)if(h=this._removeObjectByObject(o.shunzi[n],t.unpack(o.feiji)),d=this._removeObjectByObject(o.shunzi[n],t.unpack(o.duizi)),3>=h.length||2>=d.length)return!0;for(n=0;n<o.longShunzi.length;n++)if(l=o.longShunzi[n],s=i.tagCard(e[0]).cardValueSuper,c=i.tagCard(l[0]).cardValueSuper,f=i.tagCard(l[l.length-1]).cardValueSuper,s==c||s==f)return!0}}else if(s==a.CT_SINGLE_CONNECT){if(d=this._removeObjectByObject(h.concat(),t.unpack(o.sanzhang)),e=this._removeObjectByObject(h.concat(),t.unpack(o.duizi)),2<=h.length-d.length||e.length<=Math.floor(h.length/2))return!1;for(d=this._removeObjectByObject(h.concat(),t.unpack(o.liandui)).length<h.length,l=this._removeObjectByObject(h.concat(),t.unpack(o.feiji)).length<h.length,e=!1,n=0;n<o.longShunzi.length;){for(1<(g=this._removeObjectByObject(o.longShunzi[n].concat(),h.concat())).length&&(e=!0),c=s=!1,n=0;n<g.length;n++){var C=i.tagCard(g[n]).cardValueSuper;f=this._removeObjectByObject([g[n]],t.unpack(o.duizi)).length;i.tagCard(h[0]).cardValueSuper-1==C&&0==f?s=!0:i.tagCard(h[h.length-1]).cardValueSuper+1==C&&(C=g[n+1]&&0==this._removeObjectByObject([g[n+1]],t.unpack(o.duizi)).length,0==f||C)&&(c=!0)}3>g.length&&(s||c)&&(e=!1),3<=g.length&&s&&c&&(e=!1);break}if(!d&&!l&&!e)return!0}else if(s==a.CT_DOUBLE_CONNECT){if(!(l=this._removeObjectByObject(h.concat(),t.unpack(o.feiji)).length<h.length))return!0}else if(s==a.CT_AIRCRAFT||s==a.CT_AIRCRAFT_ONE||s==a.CT_AIRCRAFT_TWO){for(l=u.splitCardsData(h.concat()),e=this._getCardsSerialTemp(u.getSortAndDelete(l,3,3)),e=t.unpack(e),h=[],n=0;n<l.length;n++)for(d in l[n])1==l[n][d].length&&h.push(l[n][d]);for(h=this._getCardsSerialTemp(h),d=t.unpack(h),n=0;n<d.length;n++)if(14<i.tagCard(d[n]).cardValueSuper)return!1;for(h=!0,n=0;n<o.shunzi.length;n++)this._removeObjectByObject(o.shunzi[n],e).length==o.shunzi[n].length&&this._removeObjectByObject(o.shunzi[n],d).length<o.shunzi[n].length&&(h=!1);for(n=0;n<o.liandui.length;n++)this._removeObjectByObject(o.liandui[n],e).length==o.liandui[n].length&&this._removeObjectByObject(o.liandui[n],d).length<o.liandui[n].length&&(h=!1);if(h)return!0}return!1},getOneAutoPlay:function(e,t,r){e=u.getCardsData(e);var n,a=u.splitCardsData(e);(e=u.getKingBomb(a))&&2==e.length&&a.splice(a.length-2,2),e=a.concat();var i,l,g=u.getSortAndDelete(a,2,3);i=u.getDragon(g,0,3,!0),a=u.getSortAndDelete(a,1,3),l=u.getDragon(a,0,5,!0);a=[];for(var h=0;h<l.length;h++){for(var s=0,o=l[h],d=0;d<o.length;d++){g=o[d];for(var c=!1,f=0;f<e.length;f++){for(n in e[f])if(g.cardValueSuper==n){1<(c=e[f][n].length)&&(s+=c-1),c=!0;break}if(c)break}}s<o.length/2&&a.push(o)}for(h=0;h<i.length;h++){for(s=0,l=i[h],d=c=0;d<l.length;d++)if(c!=(g=l[d]).cardValueSuper)for(f=c=0;f<e.length;f++){for(n in e[f])if(g.cardValueSuper==n){2<(c=e[f][n].length)&&(s+=c-2),c=n;break}if(0!=c)break}s<l.length/4&&a.push(l)}for(s=h=i=null,d=0;d<e.length;d++){for(n in e[d]){for(g=e[d][n],f=0;f<a.length;f++)for(l=a[f],o=0;o<l.length;o++){if(n==l[o].cardValueSuper)for(c=0;c<g.length;c++)if(g[c].cardSerial==l[o].cardSerial){g.splice(c,1);break}if(0>=g.length)break}if(0<g.length&&3>g.length){h=g;break}3==g.length&&null==i?i=g:4==g.length&&null==s&&(s=g)}if(h)break}return n=null,null==h&&0<a.length?10<(h=a[0])[0].cardValueSuper&&i&&10>i[0].cardValueSuper&&(h=i):null==h&&i?h=i:null==h&&s&&(h=s),h&&(10<h[0].cardValueSuper&&14>=h[0].cardValueSuper?0<a.length&&10>=a[0][0].cardValueSuper?h=a[0]:i&&10>=i[0].cardValueSuper&&(h=i):14<h[0].cardValueSuper&&(0<a.length&&14>=a[0][0].cardValueSuper?h=a[0]:i&&14>=i[0].cardValueSuper&&(h=i)),n=this._getCardsSerialTemp([h]),n=this._getOutCardInfo(n,t,r)),n[0]},getDanPaiTipArray:function(e,r){var n=e.dan;if(0<n.length)for(var a=i.tagCard(r).cardValueSuper,l=0;l<n.length;l++){var g=i.tagCard(n[l]).cardValueSuper;a>=g&&(n.splice(l,1),--l)}if(0<e.feiji.length&&(n=this._removeObjectByObject(n,t.unpack(e.feiji))),0<e.liandui.length&&(n=this._removeObjectByObject(n,t.unpack(e.liandui))),a=[],0<e.shunzi.length&&0<n.length)for(l=0;l<e.shunzi.length;l++)3>=(g=this._removeObjectByObject(e.shunzi[l],t.unpack(e.feiji))).length||(2>=(g=this._removeObjectByObject(e.shunzi[l],t.unpack(e.liandui))).length||(2>=(g=this._removeObjectByObject(e.shunzi[l],t.unpack(e.duizi))).length||(g=e.shunzi[l],n=this._removeObjectByObject(n,g),a.push(g))));if(0<e.sanzhang.length&&0<n.length)for(l=0;l<e.sanzhang.length;l++)n=this._removeObjectByObject(n,e.sanzhang[l]);if(0<e.duizi.length&&0<n.length)for(l=0;l<e.duizi.length;l++)g=e.duizi[l],0<a.length&&(g=this._removeObjectByObject(g,t.unpack(a))),g.length==e.duizi[l].length&&(n=this._removeObjectByObject(n,g));if(0<n.length&&(n=u.splitCardsData(n),n=u.getSortAndDelete(n,1,3,r)),0>=n.length&&0<e.duizi.length&&(n=t.unpack(e.duizi),a={dan:0,duizi:0,longShunzi:0,sanzhang:1,liandui:1,feiji:0},n=this._getArrange(n,e,a,1,r)),0>=n.length&&0<e.sanzhang.length&&(n=t.unpack(e.sanzhang),a={dan:0,duizi:0,longShunzi:0,sanzhang:0,liandui:1,feiji:1},n=this._getArrange(n,e,a,1,r)),0>=n.length&&0<e.longShunzi.length)for(n=[],l=0;l<e.longShunzi.length&&(g=e.longShunzi[l],a={dan:0,duizi:0,longShunzi:0,sanzhang:0,liandui:1,feiji:1},0<(n=6<=(g=this._removeCards(g,e,a)).length?t.addObjects(n,[g[0],g[g.length-1]]):t.addObjects(n,g)).length&&(n=u.splitCardsData(n),n=u.getSortAndDelete(n,1,3,r)),!(0<n.length));l++);if(0>=n.length&&0<e.liandui.length)for(n=[],l=0;l<e.liandui.length&&(g=e.liandui[l],a={dan:0,duizi:0,longShunzi:0,sanzhang:0,liandui:0,feiji:1},0<(n=3<(g=this._removeCards(g,e,a)).length/2?t.addObjects(n,[g[0],g[g.length-1]]):t.addObjects(n,g)).length&&(n=u.splitCardsData(n),n=u.getSortAndDelete(n,1,3,r)),!(0<n.length));l++);return 0>=n.length&&0<e.feiji.length&&(0<(n=t.unpack(e.feiji)).length&&(n=u.splitCardsData(n),n=u.getSortAndDelete(n,1,3,r))),n},getDuiZiTipArray:function(e,r){var n=t.unpack(e.duizi);if(0<n.length&&(n=u.splitCardsData(n),n=t.unpack(this._getCardsSerialTemp(u.getSortAndDelete(n,2,3,r)))),0<e.duizi.length&&0<n.length)for(var a=0;a<e.duizi.length;a++){var l=e.duizi[a];if(2>(l=this._removeObjectByObject(l,t.unpack(e.feiji))).length)n=this._removeObjectByObject(n,e.duizi[a]);else if(2>(l=this._removeObjectByObject(l,t.unpack(e.liandui))).length)n=this._removeObjectByObject(n,e.duizi[a]);else{for(var g=[],h=0;h<e.shunzi.length;h++){var s=this._removeObjectByObject(e.shunzi[h],t.unpack(e.feiji));if(!(3>=s.length||(s=this._removeObjectByObject(e.shunzi[h],t.unpack(e.liandui)),2>=s.length||(s=this._removeObjectByObject(e.shunzi[h],t.unpack(e.duizi)),2>=s.length||(s=e.shunzi[h],l=this._removeObjectByObject(l,s),!(2>l.length)))))){l=e.duizi[a],l=this._removeObjectByObject(l,t.unpack(e.sanzhang));for(var o=!1,d=0;d<e.longShunzi.length;d++){if(!(5>=(f=e.longShunzi[d]).length)){var c=i.tagCard(f[0]).cardValueSuper,f=i.tagCard(f[f.length-1]).cardValueSuper,C=i.tagCard(e.duizi[a][0]).cardValueSuper;if(c==C||f==C){o=!0;break}}}2!=l.length||o||(g.push(s),n=this._removeObjectByObject(n,e.duizi[a]))}}2>(l=this._removeObjectByObject(l,t.unpack(e.sanzhang))).length&&(l=e.duizi[a],2==(l=this._removeObjectByObject(l,t.unpack(g))).length&&(n=this._removeObjectByObject(n,e.duizi[a])))}}if(2<=n.length&&(n=u.splitCardsData(n),n=u.getSortAndDelete(n,2,3,r)),0>=n.length&&0<e.duizi.length&&(n=t.unpack(e.duizi),l={dan:0,duizi:0,longShunzi:0,sanzhang:1,liandui:1,feiji:1},n=this._getArrange(n,e,l,2,r)),0>=n.length&&0<e.sanzhang.length&&(n=t.unpack(e.sanzhang),l={dan:0,duizi:0,longShunzi:0,sanzhang:0,liandui:1,feiji:1},n=this._getArrange(n,e,l,2,r)),0>=n.length&&0<e.liandui.length)for(n=[],a=0;a<e.liandui.length&&(g=e.liandui[a],l={dan:0,duizi:0,longShunzi:0,sanzhang:0,liandui:0,feiji:1},0<(n=3<(g=this._removeCards(g,e,l)).length/2?t.addObjects(n,[g[0],g[1],g[g.length-2],g[g.length-1]]):t.addObjects(n,g)).length&&(n=u.splitCardsData(n),n=u.getSortAndDelete(n,2,3,r)),!(0<n.length));a++);return 0>=n.length&&0<e.feiji.length&&(0<(n=t.unpack(e.feiji)).length&&(n=u.splitCardsData(n),n=u.getSortAndDelete(n,2,3,r))),n},getSanZhangTipArray:function(e,r){var n=t.unpack(e.sanzhang);0<n.length&&(n=u.splitCardsData(n),n=t.unpack(this._getCardsSerialTemp(u.getSortAndDelete(n,3,3,r))));var a={dan:0,duizi:0,longShunzi:1,sanzhang:0,liandui:1,feiji:1};return 0>=(a=this._getArrange(n,e,a,3,r)).length&&(a={dan:0,duizi:0,longShunzi:0,sanzhang:0,liandui:1,feiji:1},a=this._getArrange(n,e,a,3,r)),0>=a.length&&0<e.liandui.length&&(a={dan:0,duizi:0,longShunzi:0,sanzhang:0,liandui:0,feiji:1},a=this._getArrange(n,e,a,3,r)),0>=a.length&&0<e.feiji.length&&(0<(n=t.unpack(e.feiji)).length&&(n=u.splitCardsData(n),a=u.getSortAndDelete(n,3,3,r))),a},getShunZiTipArray:function(e,r){if(0==e.shunzi.length)return[];var n=function(t,r,n){var a=[],i=[];if(0<t.length)for(this._sortTipArr(t,e,n),n=0;n<t.length;n++)t[n].removeCardsNum<r?a.push(t[n]):i.push(t[n]);return{tipTempEnd:a,tipTemp:i}}.bind(this),a=this._screenConformTipArr(e.shunzi,r),i=e.shunzi[0].length,u=n(a,i,{dan:0,duizi:0,shunzi:0,sanzhang:0,liandui:0,feiji:1}),l=n(a=u.tipTemp,i,{dan:0,duizi:0,shunzi:0,sanzhang:0,liandui:1,feiji:0}),g=n(a=l.tipTemp,i,{dan:0,duizi:0,shunzi:0,sanzhang:1,liandui:0,feiji:0});n=n(a=g.tipTemp,i,{dan:0,duizi:1,shunzi:0,sanzhang:0,liandui:0,feiji:0}),a=[],a=t.insertObjects(a,u.tipTempEnd),a=t.insertObjects(a,l.tipTempEnd),a=t.insertObjects(a,g.tipTempEnd),a=t.insertObjects(a,n.tipTempEnd),a=t.insertObjects(a,n.tipTemp);return this._getCardsDataTemp(a)},getLianDuiTipArray:function(e,t){var r=this._screenConformTipArr(e.liandui,t);return this._sortTipArr(r,e,{dan:0,duizi:0,longShunzi:0,sanzhang:1,liandui:0,feiji:1}),this._getCardsDataTemp(r)},getFeiJiTipArray:function(e,t){var r=this._screenConformTipArr(e.feiji,t);return 1<r.length&&this._sortTipArr(r,e,{dan:0,duizi:0,longShunzi:0,sanzhang:0,liandui:1,feiji:0}),this._getCardsDataTemp(r)},isHaveMoreBombA:function(e){var t=i.tagLZOutCard(a.CT_BOMB_FOUR,4,r.Hei_1,[r.Hei_1,r.Hong_1,r.Mei_1,r.Fang_1]),n=[];return 0!=t.OutCardType&&(n=this.getOutCardArray({handCard:e.handCard,lastOutCardInfo:t,isMingPaiRoom:e.isMingPaiRoom,isFriendLianZha:e.isFriendLianZha})),0<n.length},_getAllCardArray:function(e,t,r,n){e=e.concat();var i=u.splitCardsData(e),l={};t=t||[2,3,5];var g=!0,h=4;r!=a.CT_DOUBLE_CONNECT&&r!=a.CT_SINGLE_CONNECT||(g=!1),r==a.CT_SINGLE&&(h=3),r=u.getSortAndDelete(i,3,h);var s=u.getDragon(r,0,t[0]);return l.feiji=this._getCardsSerialTemp(s),n==a.CT_AIRCRAFT||n==a.CT_AIRCRAFT_ONE||n==a.CT_AIRCRAFT_TWO?l:(l.sanzhang=this._getCardsSerialTemp(r),n==a.CT_THREE_LINE_TAKE_ONE||n==a.CT_THREE_LINE_TAKE_TWO||n==a.CT_BOMB_THREE?l:(r=u.getSortAndDelete(i,2,h),s=u.getDragon(r,0,t[1],g),l.liandui=this._getCardsSerialTemp(s),n==a.CT_DOUBLE_CONNECT?l:(l.duizi=this._getCardsSerialTemp(r),n==a.CT_DOUBLE?l:(h=u.getSortAndDelete(i,1,h),g=u.getDragon(h,0,t[2],g),l.longShunzi=this._getCardsSerialTemp(g),t=u.getDragon(h,0,t[2]),l.shunzi=this._getCardsSerialTemp(t),n==a.CT_SINGLE_CONNECT||((n=u.getKingBomb(i))&&2==n.length&&(e=this._removeObjectByObject(e,[65,66])),u.getSortAndDelete(i,1,3),l.dan=e),l))))},_getAllOutCard:function(e,r,n){for(var i,u=[],l=[],g=!0;g;)0<l.length&&(l=this._getCardsSerialTemp(l),e=this._removeObjectByObject(e,t.unpack(l))),i=this._getAllCardArray(e,null,n),n==a.CT_SINGLE?l=this.getDanPaiTipArray(i,r):n==a.CT_DOUBLE?l=this.getDuiZiTipArray(i,r):n!=a.CT_BOMB_THREE&&n!=a.CT_THREE_LINE_TAKE_ONE&&n!=a.CT_THREE_LINE_TAKE_TWO||(l=this.getSanZhangTipArray(i,r)),0<l.length?u=u.concat(l):g=!1;return u},_getOutCardInfo:function(e,t,r){for(var n=[],a=0;a<e.length;a++){var u=l.getCardsInfo(e[a],null,t,r);n.push(u)}for(t=n.concat(),e=[],a=0;a<t.length;a++)for(r=0;r<t.length&&a!=r&&t[a].OutCardType==t[r].OutCardType;r++){(u=i.tagCard(t[a].MaxOutCard).cardValueSuper)==i.tagCard(t[r].MaxOutCard).cardValueSuper&&e.push(a)}for(t=[],a=0;a<e.length;a++)0>t.indexOf(e[a])&&t.push(e[a]);for(a=e=0;a<t.length;a++)n.splice(t[a]-e,1),e+=1;return n},_getArrange:function(e,t,r,n,a){if(0<(e=this._removeCards(e,t,r)).length){for(t=[],r=0;r<e.length;r++)0>t.indexOf(e[r])&&t.push(e[r]);e=u.splitCardsData(t),e=u.getSortAndDelete(e,n,4,a)}return e},_removeCards:function(e,r,n){return 0<r.feiji.length&&n.feiji&&(e=this._removeObjectByObject(e,t.unpack(r.feiji))),0<r.liandui.length&&n.liandui&&(e=this._removeObjectByObject(e,t.unpack(r.liandui))),0<r.sanzhang.length&&n.sanzhang&&(e=this._removeObjectByObject(e,t.unpack(r.sanzhang))),0<r.longShunzi.length&&n.longShunzi&&(e=this._removeObjectByObject(e,t.unpack(r.longShunzi))),0<r.duizi.length&&n.duizi&&(e=this._removeObjectByObject(e,t.unpack(r.duizi))),e},_getCardsSerialTemp:function(e){for(var t=[],r=0;r<e.length;r++)t.push(u.getCardsSerial(e[r]));return t},_getCardsDataTemp:function(e){for(var t=[],r=0;r<e.length;r++)t.push(u.getCardsData(e[r].cards));return t},_deleteEqual:function(e){for(var t=[],r=0;r<e.length;r++)0>t.indexOf(e[r])&&t.push(e[r]);return t},_removeObjectByObject:function(e,t){var r=[];return t&&e.forEach((function(e){-1===t.indexOf(e)&&r.push(e)})),r},_removeObjectByCardValueSuper:function(e,t){var r,n=[];for(r in e){var a,u=!1;for(a in t)if(i.tagCard(e[r]).cardValueSuper==i.tagCard(t[a]).cardValueSuper){u=!0;break}u||n.push(e[r])}return e},_getChooseLength:function(e,t){var r=void 0;return e==a.CT_DOUBLE_CONNECT?r=[2,t/2,5]:e==a.CT_SINGLE_CONNECT?r=[2,3,t]:e==a.CT_AIRCRAFT_TWO?r=[t/5,2,5]:e==a.CT_AIRCRAFT_ONE?r=[t/4,2,5]:e==a.CT_AIRCRAFT&&(r=[t/3,2,5]),r},_screenConformTipArr:function(e,t){for(var r=e.concat(),n=[],a=0;a<r.length;a++){for(var u=i.tagCard(r[a][0]).cardValueSuper,l=0;l<r[a].length;l++){var g=i.tagCard(r[a][l]).cardValueSuper;u<g&&(u=g)}u>(l=i.tagCard(t).cardValueSuper)&&((u={}).cards=r[a],n.push(u))}return n},_sortTipArr:function(e,t,r,n){n=n||"removeCardsNum",this._addTipArrField(e,t,r,n),this._publicSort(e,n)},_addTipArrField:function(e,t,r,n){for(var a=0;a<e.length;a++){var i=this._removeCards(e[a].cards,t,r);e[a][n]=i.length}},_publicSort:function(e,t){e=e.sort((function(e,r){return r[t]-e[t]}))}},s={isFit:function(e){var t=e.length/3;if(0!=e.length%3)return null;e=u.getCardsData(e),e=u.splitCardsData(e);var r=u.getSortAndDelete(e,3,4);return 1>=r.length?null:(e=r[r.length-1][1].cardSerial,15<=r[r.length-1][1].cardValueSuper||1!=(r=u.getDragon(r,0,t)).length?null:e)}},o={isFit:function(e,t,r){var n=null,a=e.length/5;if(0!=e.length%5||1>=a)return null;if(n=u.getCardsData(e),n=u.splitCardsData(n),1<=u.getBombTab(n,null,t,r).length)return null;if(t=u.getSortAndDelete(n,3,4),1!=(n=u.getDragon(t,0,a)).length)return null;if(n=u.getMax(n[0]).cardSerial,15<=t[t.length-1][1].cardValueSuper)return null;e=u.splitCardsData(e),r=[];for(var i=0;i<t.length;i++){var l=t[i];e=r=e.filter((function(e){for(var t in e)if(e.hasOwnProperty(t))return e[t][0].cardValue!=l[0].cardValue}))}return u.getSortAndDelete(r,2,2).length!=a?null:n}},d={isFit:function(e,t,r){var n=e.length/4;return 0!=e.length%4||1>=n?null:(e=u.getCardsData(e),e=u.splitCardsData(e),1<=u.getBombTab(e,null,t,r).length?null:(t=u.getSortAndDelete(e,3,4),1!=(n=u.getDragon(t,0,n)).length||15<=(n=u.getMax(n[0])).cardValueSuper?null:n.cardSerial))}},c={isFit:function(e,t,r){var n;return n=e.length/5,0!=e.length%5||1>=n?null:(e=u.getCardsData(e),e=u.splitCardsData(e),1<=u.getBombTab(e,null,t,r).length?null:(t=u.getSortAndDelete(e,3,4),1!=(n=u.getDragon(t,0,n)).length?null:(n=u.getMax(n[0]).cardSerial,15<=t[t.length-1][1].cardValueSuper?null:n)))}},f={isFit:function(e){var t=null;if(4!=(e=u.getCardsData(e)).length)return t;var r=e[1].cardValueSuper==e[2].cardValueSuper,n=e[2].cardValueSuper==e[3].cardValueSuper;return e[0].cardValueSuper==e[1].cardValueSuper&&r&&n?t=e[0].cardSerial:t}},C={isFit:function(e){var t=null;return 2!=(e=u.getCardsData(e)).length||e[0].cardValueSuper==e[1].cardValueSuper&&(t=e[0].cardSerial),t}},_={isFit:function(e){var t=null;if(e=u.getCardsData(e),u.sortCardsData(e),0!=e.length%2||4>e.length)return t;for(var r=0;r<e.length;r++){var n=e[r+1]&&0==r%2&&e[r].cardValueSuper+1!=e[r+1].cardValueSuper;if(0==r%2&&e[r-1]&&e[r-1].cardValueSuper!=e[r].cardValueSuper||n)return t}return 14<e[e.length-1].cardValueSuper?t:t=e[e.length-1].cardSerial}},p={isFit:function(e){var t=null;if(e=u.getCardsData(e),u.sortCardsData(e),0!=e.length%2||6>e.length)return t;for(var r=0;r<e.length;r++){var n=e[r+1]&&0==(r+1)%2&&e[r].cardValueSuper+1!=e[r+1].cardValueSuper;if(e[r-1]&&0==(r+1)%2&&e[r-1].cardValueSuper!=e[r].cardValueSuper||n)return t}return 14<e[e.length-1].cardValueSuper?t:t=e[e.length-1].cardSerial}},O={isFit:function(e){return 0}},T={isFit:function(e){var t=null,r=u.getCardsData(e);if(e=u.splitCardsData(r),8!=r.length||3!=e.length)return t;for(var n=r=0;n<e.length;n++){var a,i=e[n];for(a in i)i.hasOwnProperty(a)&&(4==i[a].length&&(t=i[a][0].cardSerial),2==i[a].length&&(r+=1))}return 2!=r?null:t}},S={isFit:function(e){var t=null;if(7!=(e=u.getCardsData(e)).length)return t;e=u.splitCardsData(e);for(var r=0;r<e.length;r++){var n,a=e[r];for(n in a)if(4==a[n].length){t=a[n][0].cardSerial;break}}return t}},v={isFit:function(e){var t=null,r=u.getCardsData(e);if(e=u.splitCardsData(r),6!=r.length)return t;r=[];for(var n=0;n<e.length;n++){var a,i=e[n];for(a in i)i.hasOwnProperty(a)&&(4==i[a].length&&(t=i[a][0].cardSerial),1==i[a].length&&r.push(i[a][0]))}return 2==r.length&&(65==r[0].cardSerial&&66==r[1].cardSerial||65==r[1].cardSerial&&66==r[0].cardSerial)?null:t}},D={isFit:function(e){if(2!=e.length)return null;var t=66==e[0]&&65==e[1];return 65==e[0]&&66==e[1]||t?66:null}},b={isFit:function(e){var t=null;if(20!=e.length)return t;e=u.getCardsData(e),e=u.splitCardsData(e);var r=(e=u.getLineBomb(e,5,5)).length;return 0==r?t:t=u.getMax(e[r-1]).cardSerial}},j={isFit:function(e){var t=null;if(16!=e.length)return t;e=u.getCardsData(e),e=u.splitCardsData(e);var r=(e=u.getLineBomb(e,4,4)).length;return 0==r?t:t=u.getMax(e[r-1]).cardSerial}},B={isFit:function(e){var t=null;if(12!=e.length)return t;e=u.getCardsData(e),e=u.splitCardsData(e);var r=(e=u.getLineBomb(e,3,3)).length;return 0==r?t:t=u.getMax(e[r-1]).cardSerial}},A={isFit:function(e){var t=null;if(8!=e.length)return t;e=u.getCardsData(e),e=u.splitCardsData(e);var r=(e=u.getLineBomb(e,2,2)).length;return 0==r?t:t=u.getMax(e[r-1]).cardSerial}},m={isFit:function(e){var t=null;return 1==(e=u.getCardsData(e)).length&&(t=e[0].cardSerial),t}},E={isFit:function(e){var t=null;if(e=u.getCardsData(e),u.sortCardsData(e),5>e.length)return t;for(var r=1;r<e.length;r++)if(e[r-1].cardValueSuper+1!=e[r].cardValueSuper)return t;return 14<e[e.length-1].cardValueSuper?t:t=e[e.length-1].cardSerial}},z={isFit:function(e){var t=null;return 3!=(e=u.getCardsData(e)).length||e[0].cardValueSuper==e[1].cardValueSuper&&e[1].cardValueSuper==e[2].cardValueSuper&&(t=e[0].cardSerial),t}},V={isFit:function(e){var t=null,r=u.getCardsData(e);if(e=u.splitCardsData(r),5!=r.length||2!=e.length)return t;for(r=0;r<e.length;r++){var n,a=e[r];for(n in a)if(a.hasOwnProperty(n)&&(3==a[n].length&&(t=a[n][0].cardSerial),1==a[n].length)){t=null;break}}return t}},y={isFit:function(e){var t=null,r=u.getCardsData(e);r=u.splitCardsData(r);if(4!=e.length||2!=r.length)return t;for(e=0;e<r.length;e++){var n,a=r[e];for(n in a)if(a.hasOwnProperty(n)&&3==a[n].length){t=a[n][0].cardSerial;break}}return t}},R={isFit:function(e){var t=null;if(5!=(e=u.getCardsData(e)).length)return t;e=u.splitCardsData(e);for(var r=0;r<e.length;r++){var n,a=e[r];for(n in a)if(a.hasOwnProperty(n)&&3==a[n].length){t=a[n][0].cardSerial;break}}return t}},F={init:function(e,t){for(var r=[],n=0;n<t;n++)r[n]=e;return r},copy:function(e){return e.concat()},deepCopy:function(e){return deepClone(e)},addObject:function(e,t){return e.push(t),e},addObjects:function(e,t){for(var r=0;r<t.length;r++)e.push(t[r]);return e},insertObject:function(e,t){return e.unshift(t),e},insertObjects:function(t,r){e.assert(Array.isArray(t),"vsdz-VSDZArrayEx-insertObjects-array\u5fc5\u987b\u662f\u6570\u7ec4"),e.assert(Array.isArray(r),"vsdz-VSDZArrayEx-insertObjects-objs\u5fc5\u987b\u662f\u6570\u7ec4");for(var n=r.length-1;0<=n;n--)t.unshift(r[n]);return t},insertObjectAtIndex:function(e,t,r){return e.splice(t,0,r),e},insertObjectsAtIndex:function(e,t,r){return e.splice(t,0,r),e},insertObjectsAtIndexs:function(t,r,n){e.assert(n.length==r.length,"vsdz-VSDZArrayEx-insertObjectsAtIndexs-\u957f\u5ea6\u4e0d\u7b49");for(var a=0;a<r.length;a++)this.insertObjectAtIndex(t,r[a]+a,n[a]);return t},find:function(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return e[r]},notEmpty:function(e){var t=[];return e.map((function(e,r){""!==e&&null!=e&&null!=e&&t.push(e)})),t},hasEmpty:function(e){for(var t=0;t<e.length;t++)if(null==e[t])return!0;return!1},findIndex:function(e,t){for(var r=0;r<e.length;r++)if(e[r]==t)return r},indexOf:function(e,t,r){for(var n=0;n<e.length;n++)if(e[n][t]==r)return n;return-1},findSetByCondition:function(e,t){for(var r=[],n=0;n<e.length;n++)t(e[n])&&r.push(e[n]);return r},removeObject:function(e,t){return this.removeObjectByCondition(e,(function(e){return e==t}))},removeObjectByCondition:function(e,t){for(var r in e)if(t(e[r])){for(;r<e.length-1;r++){var n=parseInt(r)+1;e[r]=e[n]}e.pop();break}return e},removeAllObject:function(e,t){return this.removeAllObjectByCondition(e,(function(e){return e==t}))},deleteAnotherTable:function(e,t){if(e&&t)for(var r=0;r<t.length;r++)for(var n=0;n<e.length;n++)if(e[n]==t[r]){e.splice(n,1);break}return e},removeAllObjectByCondition:function(e,t){for(var r=e.length-1;0<=r;r--)t(e[r])&&e.splice(r,1);return e},removeLastObject:function(e){return e.pop(),e},removeFirstObject:function(e){return e.shift(),e},isValueExist:function(e,t){for(var r in e)if(e[r]==t)return!0;return!1},concat:function(e,t){return e.join(t)},append:function(e,t){return e.concat(t)},unpack:function(e){for(var t=[],r=0;r<e.length;r++)for(var n=e[r],a=0;a<n.length;a++)t.push(n[a]);return t},reverse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n]=e[t-n-1];return r},sort:function(e){return e.sort((function(e,t){return e<t?-1:e>t?1:0}))},sortReverse:function(e){return e.sort((function(e,t){return e<t?1:e>t?-1:0}))},sortByCondition:function(e,t){var r=e.length;if(2>r)return e;for(var n=[];0<r;){var a=e[a=this._findKey(e,t)];n.push(a),F.removeObject(e,a),--r}for(r=0;r<n.length;r++)e[r]=n[r];return e},classify:function(e,t){for(var r=[],n=[],a=0;a<e.length;a++){var i=e[a];t(i)?r.push(i):n.push(i)}for(a=0;a<r.length;a++)e[a]=r[a];for(r=r.length,a=0;a<n.length;a++)e[a+r]=n[a]},classifyToArray:function(e,t){for(var r={},n=0;n<e.length;n++){var a=e[n],i=t(a),u=r[i]||[];u.push(a),r[i]=u}for(i in n=[],r)n.push(r[i]);return n},_findKey:function(e,t){var r=e.length;if(1==e.length)return 0;for(var n=0,a=e[n],i=1;i<r;i++)t(a,e[i])||(a=e[n=i]);return n},unique:function(e){for(var t=[],r=0,n=e.length;r<n;r++){var a=e[r];-1===t.indexOf(a)&&t.push(a)}return t},jointly:function(e,t){return e.filter((function(e){return-1<t.indexOf(e)}))}},k={Invalid:0,Rear:255,Fang_1:1,Fang_2:2,Fang_3:3,Fang_4:4,Fang_5:5,Fang_6:6,Fang_7:7,Fang_8:8,Fang_9:9,Fang_10:10,Fang_J:11,Fang_Q:12,Fang_K:13,Mei_1:17,Mei_2:18,Mei_3:19,Mei_4:20,Mei_5:21,Mei_6:22,Mei_7:23,Mei_8:24,Mei_9:25,Mei_10:26,Mei_J:27,Mei_Q:28,Mei_K:29,Hong_1:33,Hong_2:34,Hong_3:35,Hong_4:36,Hong_5:37,Hong_6:38,Hong_7:39,Hong_8:40,Hong_9:41,Hong_10:42,Hong_J:43,Hong_Q:44,Hong_K:45,Hei_1:49,Hei_2:50,Hei_3:51,Hei_4:52,Hei_5:53,Hei_6:54,Hei_7:55,Hei_8:56,Hei_9:57,Hei_10:58,Hei_J:59,Hei_Q:60,Hei_K:61,King_1:65,King_2:66},N={Fang:0,Mei:1,Hong:2,Hei:3,King:4,Invalid:5},I={CT_ERROR:0,CT_SINGLE:1,CT_DOUBLE:2,CT_SINGLE_CONNECT:3,CT_DOUBLE_CONNECT:4,CT_CHA:5,CT_THREE_LINE_TAKE_ONE:6,CT_THREE_LINE_TAKE_TWO:7,CT_FOUR_LINE_TAKE_TWO:8,CT_FOUR_LINE_TAKE_ONE:9,CT_AIRCRAFT:10,CT_AIRCRAFT_ONE:11,CT_AIRCRAFT_TWO:12,CT_BOMB_THREE:13,CT_BOMB_FOUR_RL:14,CT_BOMB_FOUR:15,CT_BOMB_FOUR_L:16,CT_BOMB_FIVE_RL:17,CT_BOMB_FIVE_L:18,CT_BOMB_SIX_RL:19,CT_BOMB_SIX_L:20,CT_BOMB_SEVEN_RL:21,CT_BOMB_SEVEN_L:22,CT_BOMB_EIGHT_RL:23,CT_BOMB_EIGHT_L:24,CT_BOMB_NINE_RL:25,CT_BOMB_TEN_RL:26,CT_BOMB_ELEVEN_RL:27,CT_BOMB_TWELVE_RL:28,CT_KINGBOMB1:29,CT_KINGBOMB2:30,CT_KINGBOMB3:31,CT_KINGBOMB4:32,CT_KINGBOMB5:33},M={isValidCard:function(e){return PKCardKit.isValidCard(e)},getCardPoint:function(e){return PKCardKit.getCardPoint(e)},getCardColor:function(e){return PKCardKit.getCardColor(e)},tagCard:function(e){var t={cardSerial:e=e||0,cardValue:e%16,cardShowNum:e%16,cardType:Math.floor(e/16)};if(null!=this.TagCardSortFun)return this.TagCardSortFun(t);if(this.getRule){var r=this.getRule();if(null!=r)return this.initByRule(e,r)}return t.cardValueSuper=t.cardValue,3>=t.cardType?1!=t.cardValue&&2!=t.cardValue||(t.cardValueSuper=t.cardValue+13):(t.cardValueSuper=t.cardValue+15,t.cardShowNum+=13),t.cardOrderId=10*t.cardValueSuper+t.cardType,t},initByRule:function(e,t){var r={cardSerial:e=e||0,cardValue:e%16,cardShowNum:e%16,cardType:Math.floor(e/16)};return r.cardValueSuper=r.cardValue,r.cardType<N.King&&t[r.cardValue]&&(r.cardValueSuper=t[r.cardValue]),r.cardOrderId=10*r.cardValueSuper+r.cardType,r},tagLZOutCard:function(e,t,r,n,a,i){return{OutCardType:e||0,OutCardCount:t||0,MaxOutCard:r||0,vNotLZCard:n||[],vLZCard:a||[],vLZReplaceCard:i||[]}},setTagCardSortFun:function(e){console.warn("VSDZTools.setTagCardSortFun \u8be5\u65b9\u6cd5\u7981\u6b62\u8c03\u7528\uff0c\u4f1a\u6c61\u67d3\u5168\u5c40\u53d8\u91cf"),this.TagCardSortFun=e||void 0},setRule:function(e){this.mSortRuleTab=e||void 0},getRule:function(){return this.mSortRuleTab},clearRule:function(){this.TagCardSortFun=this.mSortRuleTab=void 0},GetCardNodesArray:function(e,t){for(var r=[],n=[],a=0;a<t.length;a++)this.GetCardNode(r,e,t[a],n);return r.concat(n)},GetCardNode:function(e,t,r,n){for(var a=0;a<t.length;a++){var i=t[a];if(null!=i.length){for(var u=0;u<i.length;u++)if(r.getCardValue()==i[u])return e[a]=null==e[a]?[]:e[a],e[a].push(r),void i.splice(u,1)}else if(r.getCardValue()==t[a]){n.push(r),t.splice(a,1);break}}}},L={getCardsData:function(t){if(e.assert(Array.isArray(t),"vsdz-VSDZRule-getCardsData-cardsSerial\u5fc5\u987b\u662f\u6570\u7ec4"),"number"!=typeof t[0])return t;for(var r=[],n=0;n<t.length;n++)r.push(M.tagCard(t[n]));return this.sortCardsData(r)},getCardsSerial:function(t){if(e.assert(Array.isArray(t),"vsdz-VSDZRule-getCardsSerial-cardsData\u5fc5\u987b\u662f\u6570\u7ec4"),"number"==typeof t[0])return t;for(var r=[],n=0;n<t.length;n++)r.push(t[n].cardSerial);return r},sortCardsData:function(e){return e.sort((function(e,t){return e.cardSerial-t.cardSerial})),e.sort((function(e,t){return e.cardValueSuper-t.cardValueSuper})),e},sortVSDZCards:function(e){return e.sort((function(e,t){var r=M.tagCard(e);return M.tagCard(t).cardOrderId-r.cardOrderId})),e},splitCardsData:function(e){var t=this.getCardsData(e);t=this.sortCardsData(t);e=[];for(var r=[],n=0;n<t.length;n++){var a=t[n],i=a.cardValueSuper;e[i]?e[i].push(a):e[i]=[a]}for(i in e)(t={})[i]=e[i],r.push(t);return r},getSortAndDelete:function(e,t,r,n){n=M.tagCard(n).cardValueSuper;for(var a=[],i=0;i<e.length;i++){var u,l=e[i];for(u in l){var g=l[u];g.length>=t&&g.length<=r&&g[0].cardValueSuper>n&&(g=g.slice(0,t),a.push(g))}}return a},additionalData:function(e,t,r,n,a,i,u,l){null==n&&(n=1),i=null==i||i;var g=[],h=[];g.isFront=!1,g.curCards=h;var s=r*n;if(s>t.length)return g;for(var o=0;o<e.length;o++){for(var d=e[o],c=t.concat(),f=0;f<d.length;f++)this._removeByValue(c,"cardValueSuper",d[f].cardValueSuper,!0);var C=c.concat(),_=this.splitCardsData(c),p=this.getBombTab(_,null,u,l);for(f=0;f<p.length;f++)for(var O=p[f],T=0;T<O.length;T++)this._removeByValue(c,"cardValueSuper",O[T].cardValueSuper,!0);if(f=[],2==n&&(_=this.splitCardsData(c),f=this.getSortAndDelete(_,n,4)),s>c.length||2==n&&r>f.length)c=C,0<(d=this._addCardData(d,c,r,n,i)).length&&h.push(d),g.isFront=!0;else{if(C=c.concat(),null!=a&&s>=a)for(p=d[0].cardValueSuper-1,O=d[d.length-1].cardValueSuper+1,_=this.getSortAndDelete(_,a,a),f=0;f<_.length;f++)(T=_[f][0].cardValueSuper)>=p&&T<=O&&this._removeByValue(c,"cardValueSuper",T,!0);if(f=[],2==n&&(_=this.splitCardsData(c),f=this.getSortAndDelete(_,n,4)),s>c.length||2==n&&r>f.length)c=C,0<(d=this._addCardData(d,c,r,n,pickMaxNum,i)).length&&h.push(d);else{for(C=c.concat(),_=this.getUnDragon(c,!0),p=this.splitCardsData(_),O=!1,f=0;f<p.length;f++)for(var S in p[f])if(p[f][S].length>=n){O=!0;break}O&&(c=_),f=[],2==n&&(_=this.splitCardsData(c),f=this.getSortAndDelete(_,n,4)),s>c.length||2==n&&r>f.length?(c=C,0<(d=this._addCardData(d,c,r,n,i)).length&&h.push(d)):s<=c.length&&(0<(d=this._addCardData(d,c,r,n,i)).length&&h.push(d))}}}return g.curCards=h,g},_addCardData:function(e,t,r,n,a){var i=[];(t=this.splitCardsData(t)).sort((function(e,t){var r,n=0,a=0;for(r in e)n=e[r].length;for(r in t)a=t[r].length;return n-a}));var u=[];if(1<n||1==n&&!a)u=this.getSortAndDelete(t,n,4);else for(a=0;a<t.length;a++)for(var l in t[a])u.push(t[a][l]);return(u=F.unpack(u)).length<r*n||(l=u.slice(0,r*n)).length>=r*n&&(i=e=e.concat(l)),i},getBombTab:function(e,t,r,n){if(r=0,n=4,t&&(r=t.MaxOutCard,n=t.OutCardCount),r==k.King_1||r==k.King_2)if(2==n)n=4;else{if(3!=n)return[];n=6}var a=M.tagCard(r).cardValueSuper;t=[],r=[];for(var i=0;i<e.length;i++){var u,l=e[i];for(u in l)l[u].length>n&&t.push(l[u]),l[u].length==n&&l[u][0].cardValueSuper>a&&t.push(l[u]);for(u in l)if(l[u][0].cardSerial==k.King_1||l[u][0].cardSerial==k.King_2)for(var g=0;g<l[u].length;g++)r.push(l[u][g])}if(t.sort((function(e,t){return e.length==t.length?e[0].cardValueSuper-t[0].cardValueSupe:e.length-t.length})),2==r.length&&4==n){for(e=!1,u=0;u<t.length;u++)if(5<=t[u].length){e=!0,t.splice(u,0,r);break}e||t.push(r)}else if(3==r.length&&7>n){for(e=!1,u=0;u<t.length;u++)if(7<=t[u].length){e=!0,t.splice(u,0,r);break}e||t.push(r)}else 4==r.length&&t.push(r);return t},getLineBomb:function(e,t,r,n){for(var a=[],i=t;i<=r;i++){var u;if(n=n&&i==t?n:0,u=this.getSortAndDelete(e,4,4,n),0<(u=this.getDragon(u,n,i)).length)for(var l in u)a.push(u[l])}return a},getKingBomb:function(e){for(var t=[],r=0;r<e.length;r++){var n,a=e[r];for(n in a){var i=a[n];if(1<=i.length&&(i[0].cardSerial==k.King_1||i[0].cardSerial==k.King_2))for(var u=0;u<i.length;u++)t.push(i[u])}}return 2<=t.length?t:null},getDragonMaxs:function(e,t){for(var r=this.getDragonMaxsWaitUnpack(e,t),n=[],a=0;a<r.length;a++)n.push(F.unpack(r[a]));return n},getDragon:function(e,t,r,n){if(t=M.tagCard(t).cardValueSuper,e=this.getDragonMaxsWaitUnpack(e,r),n&&e){for(r=[],n=0;n<e.length;n++){var a=e[n];r.push(F.unpack(a))}return 0<r.length&&r.sort((function(e,t){return t.length-e.length})),r}var i=[];for(n=0;n<e.length;n++){a=e[n];for(var u=0;u<a.length-r+1;u++){var l=a.concat().slice(u,r+u);l[l.length-1][0].cardValueSuper>t&&i.push(F.unpack(l))}}return i},getDragonMaxsWaitUnpack:function(e,t){e.sort((function(e,t){return e[0].cardValueSuper-t[0].cardValueSuper}));for(var r=[],n=[],a=0;a<e.length;a++){var i=e[a];if(0!=r.length&&e[a-1][0].cardValueSuper+1!=e[a][0].cardValueSuper&&(r.length>=t&&n.push(r),r=[]),r.push(i),a==e.length-1||14<=i[0].cardValueSuper){r.length>=t&&n.push(r);break}}return n},comparisonCardSerial:function(e,t){var r=M.tagCard(e),n=M.tagCard(t);return r.cardValueSuper==n.cardValueSuper?null:r.cardValueSuper>n.cardValueSuper},getMax:function(e){for(var t=null,r=0;r<e.length;r++){var n=e[r];0<n.cardValueSuper&&(t=n)}return t},_removeByValue:function(e,t,r,n){null==n&&(n=!1);for(var a=0;a<e.length;a++){var i=e[a];if(null!=i&&i[t]==r&&(e.splice(a,1),--a,!n))break}return e},getUnDragon:function(e,t){var r,n=[];for(r in e)if(t)n.push(e[r]);else for(var a in e[r])for(var i in e[r][a])n.push(e[r][a][i]);r=this.splitCardsData(n),a=this.getSortAndDelete(r,1,3),a=this.getDragonMaxs(a,5),r=this.getSortAndDelete(r,2,3);var u=this.getDragonMaxs(r,3);for(i=[],r=0;r<a.length;r++)i.push(L.getCardsSerial(a[r]));for(r=0;r<u.length;r++)i.push(L.getCardsSerial(u[r]));return n=L.getCardsSerial(n),this.removeObjectByObject(n,i[0])},removeObjectByObject:function(e,t){var r=[];return t&&e.forEach((function(e){-1===t.indexOf(e)&&r.push(e)})),r},IsSameByValueInTwoTable:function(e,t){if(e.length!=t.length)return!1;e=L.sortVSDZCards(e),t=L.sortVSDZCards(t);for(var r=0;r<e.length;r++)if(e[r]!=t[r])return!1;return!0},getCardPoint:function(e){return e?e&VSDZMsgDefine.CARD_VALUE:VSDZMsgDefine.SKOU_CARDTYPE_NONE},compareCardValue:function(e,t,r){return(e=SKOUUtility.getCardValue(e,r))>(t=SKOUUtility.getCardValue(t,r))?1:e<t?-1:0}},H={pkRuleTab:[],registerFunc:function(t,r){e.assert(t,"vsdz-VSDZRuleHelper-getCardsSerial-cardstype=undefined"),e.assert(r,"vsdz-VSDZRuleHelper-getCardsSerial-rule=undefined");var n=[];n.push(t),n.push(r),this.pkRuleTab.push(n)},clearRuleRegister:function(){this.pkRuleTab=[]},sortCardsValue:function(e){return e.sort((function(e,t){var r=M.tagCard(e);return M.tagCard(t).cardValueSuper-r.cardValueSuper})),e},getCardsInfo:function(t,r,n,a){e.assert(t,"vsdz-VSDZRuleHelper-getCardsInfo-cards=undefined"),t=L.getCardsSerial(t),null==r&&(r=0);var i=0;return(n=this.helpIsFit(t,void 0,n,a))&&(r=n[0],i=n[1]),M.tagLZOutCard(r,t.length,i,t,[],[])},helpIsFit:function(e,t,r,n){var a,i=null,u=function(e){if(e=g.isFit(e,r,n)){var t=[];return t.push(l),t.push(e),t}};for(a in this.pkRuleTab){var l=this.pkRuleTab[a][0],g=this.pkRuleTab[a][1];if(t){if(l==t){i=u(e);break}}else if(u(e)&&u(e)[0]){i=u(e);break}}return i},judgeMore:function(t,r,n,a){e.assert(t,"vsdz-VSDZRuleHelper-judgeMore-selectCards=undefined"),e.assert(r,"vsdz-VSDZRuleHelper-judgeMore-lastOutCardsData=undefined");var i=r.OutCardType,u=r.MaxOutCard,l=r.vNotLZCard.length;if(0==i)return 0!=this.getCardsInfo(t,null,n,a).OutCardType;if(14>i){var g=null;if((n=this.helpIsFit(t,i,n,a))&&(g=n[1]),null!=g&&L.comparisonCardSerial(g,u)&&r.OutCardCount==t.length)return!0;t=this.isFitBomb(t);var h;g=null;for(h in t)g=t[h];if(null!=g)return!0}else{for(h in a=g=null,n=this.isFitBomb(t))g=n[h],a=h;if(a==i&&(t.length>r.OutCardCount||t.length==r.OutCardCount&&L.comparisonCardSerial(g,u))||i>=I.CT_KINGBOMB1&&i<I.CT_KINGBOMB4&&a==I.CT_BOMB_FOUR&&4<t.length||i==I.CT_KINGBOMB4&&a==I.CT_BOMB_FOUR&&6<t.length||i==I.CT_BOMB_FOUR&&(4==l&&a>i||(5==l||6==l)&&31<a||6<l&&32<a)||a>i&&i!=I.CT_BOMB_FOUR)return!0}return!1},isFitBomb:function(t){for(var r in e.assert(t,"vsdz-VSDZRuleHelper-isFitBomb-selectCards=undefined"),this.pkRuleTab){var n=this.pkRuleTab[r][0],a=this.pkRuleTab[r][1];if(14<=n){a=a.isFit(t);var i={};if(i[n]=a,null!=a)return i}}return null},getSmartSelectCards:function(t,r,n,a,i,u){return e.assert(t,"vsdz-VSDZRuleHelper-getSmartSelectCards-selectCards=undefined"),null==r&&(r=3),null==n&&(n=5),null==a&&(a=2),i=this.getCardsInfo(t,null,i,u),n=this.getOngDragonMaxs(t,n),r=this.getDoubleDragonMaxs(t,r),t=this.getThreeDragonMaxs(t,a),0!=i.OutCardType?null:null!=t&&null!=r&&null!=n?(a=t.length/3,i=r.length/2,u=n.length,a>=i&&a>=u?t:a<i&&i>=u?r:n):null!=t&&null!=r?t.length/3>=r.length/2?t:r:null!=r&&null!=n?r.length/2>=n.length?r:n:n||(r||(t||null))},getOngDragonMaxs:function(e,t){var r;return e=L.getCardsData(e),r=L.splitCardsData(e),r=L.getSortAndDelete(r,1,4),0==(r=L.getDragonMaxs(r,t)).length?null:r=L.getCardsSerial(r[0])},getDoubleDragonMaxs:function(e,t){var r;return e=L.getCardsData(e),r=L.splitCardsData(e),r=L.getSortAndDelete(r,2,4),0==(r=L.getDragonMaxs(r,t)).length?null:r=L.getCardsSerial(r[0])},getThreeDragonMaxs:function(e,t){var r;return e=L.getCardsData(e),r=L.splitCardsData(e),r=L.getSortAndDelete(r,3,4),0==(r=L.getDragonMaxs(r,t)).length?null:r=L.getCardsSerial(r[0])}},Z={initRules:function(e){M.clearRule(),H.clearRuleRegister(),H.registerFunc(I.CT_SINGLE,ie),H.registerFunc(I.CT_DOUBLE,w),H.registerFunc(I.CT_BOMB_THREE,le),H.registerFunc(I.CT_SINGLE_CONNECT,ue),H.registerFunc(I.CT_DOUBLE_CONNECT,Q),H.registerFunc(I.CT_THREE_LINE_TAKE_ONE,he),H.registerFunc(I.CT_THREE_LINE_TAKE_TWO,ge),H.registerFunc(I.CT_AIRCRAFT,x),H.registerFunc(I.CT_AIRCRAFT_ONE,G),H.registerFunc(I.CT_AIRCRAFT_TWO,U),e.isFourTake&&(H.registerFunc(I.CT_FOUR_LINE_TAKE_ONE,$),H.registerFunc(I.CT_FOUR_LINE_TAKE_TWO,X)),H.registerFunc(I.CT_BOMB_FOUR,P),H.registerFunc(I.CT_KINGBOMB1,ee),H.registerFunc(I.CT_KINGBOMB2,te),H.registerFunc(I.CT_KINGBOMB3,re),H.registerFunc(I.CT_KINGBOMB4,ne),H.registerFunc(I.CT_KINGBOMB5,ae),H.registerFunc(I.CT_ERROR,q)}},K={getOutCardArray:function(e){var t=e.lastOutCardInfo,r=e.isMingPaiRoom,n=e.isFriendLianZha,a=e.handCard.concat(),i=t.MaxOutCard,u=t.vNotLZCard,l=t.OutCardType,g=L.splitCardsData(a);if(l==I.CT_SINGLE_CONNECT||l==I.CT_DOUBLE_CONNECT||l==I.CT_AIRCRAFT_TWO||l==I.CT_AIRCRAFT_ONE||l==I.CT_AIRCRAFT){e=this._getChooseLength(l,u.length);var h=this._getAllCardArray(a,e,l)}e=[];var s=[];if(l==I.CT_SINGLE_CONNECT?e=this.getShunZiTipArray(h,i):l==I.CT_DOUBLE_CONNECT?e=this.getLianDuiTipArray(h,i):l==I.CT_THREE_LINE_TAKE_TWO?(e=e.concat(this._getAllOutCard(a,i,l)),e=(e=L.additionalData(e,L.getCardsData(a),1,2,null,null,r,n)).curCards):l==I.CT_THREE_LINE_TAKE_ONE?(e=e.concat(this._getAllOutCard(a,i,l)),e=(e=L.additionalData(e,L.getCardsData(a),1,1,null,null,r,n)).curCards):l==I.CT_AIRCRAFT_TWO?(e=this.getFeiJiTipArray(h,i),h=u.length/5,e=(e=L.additionalData(e,L.getCardsData(a),h,2,null,null,r,n)).curCards):l==I.CT_AIRCRAFT_ONE?(e=this.getFeiJiTipArray(h,i),h=u.length/4,e=(e=L.additionalData(e,L.getCardsData(a),h,1,null,null,r,n)).curCards):l==I.CT_AIRCRAFT?e=this.getFeiJiTipArray(h,i):14>l&&(e=e.concat(this._getAllOutCard(a,i,l))),14>l){if(i=[],u=[],(g=L.getBombTab(g.concat(),null,r,n)).length){for(t=0;t<g.length;t++)for(l=0;l<e.length;l++)for(s=e[l],a=0;a<s.length;a++)if(s[a].cardValueSuper==g[t][0].cardValueSuper){i.push(s),u.push(l);break}e=e.concat(g)}if((u=this._deleteEqual(u)).sort(),0<i.length){for(t=l=0;t<u.length;t++)e.splice(u[t]-l,1),l+=1;e=e.concat(i)}e=this._getCardsSerialTemp(e),s=this._getOutCardInfo(e,r,n)}else for(g=L.getBombTab(g.concat(),t,r,n),r=this._getOutCardInfo(this._getCardsSerialTemp(g),r,n),t=0;t<r.length;t++)n=M.tagCard(i).cardValueSuper,e=M.tagCard(r[t].MaxOutCard).cardValueSuper,(r[t].OutCardType>l||r[t].OutCardType==l&&e>n||15==r[t].OutCardType&&r[t].OutCardCount>u.length)&&s.push(r[t]);return s},getIsAutoTipCards:function(e,t,r){var n=t.vNotLZCard,a=t.OutCardType,i=this._getAllCardArray(e);if(n.length==e.length)return!0;if(r&&(14<M.tagCard(t.MaxOutCard).cardValueSuper||13<a)||!r&&a!=I.CT_SINGLE&&(14<M.tagCard(t.MaxOutCard).cardValueSuper||13<a))return!1;if(a==I.CT_SINGLE){var u;a=!1;for(t=0;t<i.duizi.length;t++)if(r=i.duizi[t],u=0==this._removeObjectByObject(n.concat(),r).length,e=0==this._removeObjectByObject(n.concat(),F.unpack(i.sanzhang)).length,u&&!e&&(a=this._removeObjectByObject(r.concat(),F.unpack(i.longShunzi)).length<r.length),u&&a)return!0;if(u=0==this._removeObjectByObject(n.concat(),F.unpack(i.duizi)).length,e=0==this._removeObjectByObject(n.concat(),F.unpack(i.sanzhang)).length,a=this._removeObjectByObject(n.concat(),F.unpack(i.longShunzi)).length<n.length,!u&&!e&&!a)return!0;if(a){for(t=0;t<i.shunzi.length;t++)if(5>this._removeObjectByObject(i.shunzi[t],n.concat()).length&&2<(r=this._removeObjectByObject(i.shunzi[t],F.unpack(i.duizi))).length)return!1;return!0}}else if(a==I.CT_DOUBLE){if(e=this._removeObjectByObject(n.concat(),F.unpack(i.sanzhang)).length<n.length,a=this._removeObjectByObject(n.concat(),F.unpack(i.longShunzi)).length<n.length,u=this._removeObjectByObject(n.concat(),F.unpack(i.liandui)).length<n.length,a&&!e&&!u)for(t=0;t<i.longShunzi.length;t++){r=i.longShunzi[t];var l=M.tagCard(n[0]).cardValueSuper,g=M.tagCard(r[0]).cardValueSuper,h=M.tagCard(r[r.length-1]).cardValueSuper;if(5<r.length&&(l==g||l==h))return!0;if(r=i.longShunzi[t],this._removeObjectByObject(i.longShunzi[t],n.concat()).length<r.length)return!(2<(r=this._removeObjectByObject(r,F.unpack(i.duizi))).length)}if(!e&&!a&&!u)return!0}else if(a==I.CT_BOMB_THREE||a==I.CT_THREE_LINE_TAKE_ONE||a==I.CT_THREE_LINE_TAKE_TWO){if(r=L.splitCardsData(n.concat()),e=this._getCardsSerialTemp(L.getSortAndDelete(r,3,3)),e=F.unpack(e),u=this._removeObjectByObject(n.concat(),e.concat()),14<M.tagCard(u[0]).cardValueSuper)return!1;if(n=this._removeObjectByObject(u.concat(),F.unpack(i.longShunzi)).length<u.length,t=this._removeObjectByObject(u.concat(),F.unpack(i.sanzhang)).length<u.length,l=this._removeObjectByObject(u.concat(),F.unpack(i.liandui)).length<u.length,a=this._removeObjectByObject(e.concat(),F.unpack(i.longShunzi)).length<e.length,u=this._removeObjectByObject(e.concat(),F.unpack(i.liandui)).length<e.length,r=this._removeObjectByObject(e.concat(),F.unpack(i.feiji)).length<e.length,!(t||n||l||a||u||r))return!0;if(a&&!u&&!r){for(t=0;t<i.shunzi.length;t++)if(n=this._removeObjectByObject(i.shunzi[t],F.unpack(i.feiji)),u=this._removeObjectByObject(i.shunzi[t],F.unpack(i.duizi)),3>=n.length||2>=u.length)return!0;for(t=0;t<i.longShunzi.length;t++)if(r=i.longShunzi[t],l=M.tagCard(e[0]).cardValueSuper,g=M.tagCard(r[0]).cardValueSuper,h=M.tagCard(r[r.length-1]).cardValueSuper,l==g||l==h)return!0}}else if(a==I.CT_SINGLE_CONNECT){if(u=this._removeObjectByObject(n.concat(),F.unpack(i.sanzhang)),e=this._removeObjectByObject(n.concat(),F.unpack(i.duizi)),2<=n.length-u.length||e.length<=Math.floor(n.length/2))return!1;for(u=this._removeObjectByObject(n.concat(),F.unpack(i.liandui)).length<n.length,r=this._removeObjectByObject(n.concat(),F.unpack(i.feiji)).length<n.length,e=!1,t=0;t<i.longShunzi.length;){for(1<(a=this._removeObjectByObject(i.longShunzi[t].concat(),n.concat())).length&&(e=!0),g=l=!1,t=0;t<a.length;t++){var s=M.tagCard(a[t]).cardValueSuper;h=this._removeObjectByObject([a[t]],F.unpack(i.duizi)).length;M.tagCard(n[0]).cardValueSuper-1==s&&0==h?l=!0:M.tagCard(n[n.length-1]).cardValueSuper+1==s&&(s=a[t+1]&&0==this._removeObjectByObject([a[t+1]],F.unpack(i.duizi)).length,0==h||s)&&(g=!0)}3>a.length&&(l||g)&&(e=!1),3<=a.length&&l&&g&&(e=!1);break}if(!u&&!r&&!e)return!0}else if(a==I.CT_DOUBLE_CONNECT){if(!(r=this._removeObjectByObject(n.concat(),F.unpack(i.feiji)).length<n.length))return!0}else if(a==I.CT_AIRCRAFT||a==I.CT_AIRCRAFT_ONE||a==I.CT_AIRCRAFT_TWO){for(r=L.splitCardsData(n.concat()),e=this._getCardsSerialTemp(L.getSortAndDelete(r,3,3)),e=F.unpack(e),n=[],t=0;t<r.length;t++)for(u in r[t])1==r[t][u].length&&n.push(r[t][u]);for(n=this._getCardsSerialTemp(n),u=F.unpack(n),t=0;t<u.length;t++)if(14<M.tagCard(u[t]).cardValueSuper)return!1;for(n=!0,t=0;t<i.shunzi.length;t++)this._removeObjectByObject(i.shunzi[t],e).length==i.shunzi[t].length&&this._removeObjectByObject(i.shunzi[t],u).length<i.shunzi[t].length&&(n=!1);for(t=0;t<i.liandui.length;t++)this._removeObjectByObject(i.liandui[t],e).length==i.liandui[t].length&&this._removeObjectByObject(i.liandui[t],u).length<i.liandui[t].length&&(n=!1);if(n)return!0}return!1},getOneAutoPlay:function(e,t,r){var n;e=L.getCardsData(e),e=(l=L.splitCardsData(e)).concat();var a,i,u=L.getSortAndDelete(l,2,3);a=L.getDragon(u,0,3,!0),l=L.getSortAndDelete(l,1,3),i=L.getDragon(l,0,5,!0);for(var l=[],g=0;g<i.length;g++){for(var h=0,s=i[g],o=0;o<s.length;o++){u=s[o];for(var d=!1,c=0;c<e.length;c++){for(n in e[c])if(u.cardValueSuper==n){1<(d=e[c][n].length)&&(h+=d-1),d=!0;break}if(d)break}}h<s.length/2&&l.push(s)}for(g=0;g<a.length;g++){for(h=0,i=a[g],o=d=0;o<i.length;o++)if(d!=(u=i[o]).cardValueSuper)for(c=d=0;c<e.length;c++){for(n in e[c])if(u.cardValueSuper==n){2<(d=e[c][n].length)&&(h+=d-2),d=n;break}if(0!=d)break}h<i.length/4&&l.push(i)}for(h=g=a=null,o=0;o<e.length;o++){for(n in e[o]){for(u=e[o][n],c=0;c<l.length;c++)for(i=l[c],s=0;s<i.length;s++){if(n==i[s].cardValueSuper)for(d=0;d<u.length;d++)if(u[d].cardSerial==i[s].cardSerial){u.splice(d,1);break}if(0>=u.length)break}if(0<u.length&&3>u.length){g=u;break}3==u.length&&null==a?a=u:4<=u.length&&null==h&&(h=u)}if(g)break}return n=null,null==g&&0<l.length?10<(g=l[0])[0].cardValueSuper&&a&&10>a[0].cardValueSuper&&(g=a):null==g&&a?g=a:null==g&&h&&(g=h),g&&(10<g[0].cardValueSuper&&14>=g[0].cardValueSuper?0<l.length&&10>=l[0][0].cardValueSuper?g=l[0]:a&&10>=a[0].cardValueSuper&&(g=a):14<g[0].cardValueSuper&&(0<l.length&&14>=l[0][0].cardValueSuper?g=l[0]:a&&14>=a[0].cardValueSuper&&(g=a)),n=this._getCardsSerialTemp([g]),n=this._getOutCardInfo(n,t,r)),n[0]},getDanPaiTipArray:function(e,t){var r=e.dan;if(0<r.length)for(var n=M.tagCard(t).cardValueSuper,a=0;a<r.length;a++){var i=M.tagCard(r[a]).cardValueSuper;n>=i&&(r.splice(a,1),--a)}if(0<e.feiji.length&&(r=this._removeObjectByObject(r,F.unpack(e.feiji))),0<e.liandui.length&&(r=this._removeObjectByObject(r,F.unpack(e.liandui))),n=[],0<e.shunzi.length&&0<r.length)for(a=0;a<e.shunzi.length;a++)3>=(i=this._removeObjectByObject(e.shunzi[a],F.unpack(e.feiji))).length||(2>=(i=this._removeObjectByObject(e.shunzi[a],F.unpack(e.liandui))).length||(2>=(i=this._removeObjectByObject(e.shunzi[a],F.unpack(e.duizi))).length||(i=e.shunzi[a],r=this._removeObjectByObject(r,i),n.push(i))));if(0<e.sanzhang.length&&0<r.length)for(a=0;a<e.sanzhang.length;a++)r=this._removeObjectByObject(r,e.sanzhang[a]);if(0<e.duizi.length&&0<r.length)for(a=0;a<e.duizi.length;a++)i=e.duizi[a],0<n.length&&(i=this._removeObjectByObject(i,F.unpack(n))),i.length==e.duizi[a].length&&(r=this._removeObjectByObject(r,i));if(0<r.length&&(r=L.splitCardsData(r),r=L.getSortAndDelete(r,1,3,t)),0>=r.length&&0<e.duizi.length&&(r=F.unpack(e.duizi),n={dan:0,duizi:0,longShunzi:0,sanzhang:1,liandui:1,feiji:0},r=this._getArrange(r,e,n,1,t)),0>=r.length&&0<e.sanzhang.length&&(r=F.unpack(e.sanzhang),n={dan:0,duizi:0,longShunzi:0,sanzhang:0,liandui:1,feiji:1},r=this._getArrange(r,e,n,1,t)),0>=r.length&&0<e.longShunzi.length)for(r=[],a=0;a<e.longShunzi.length&&(i=e.longShunzi[a],n={dan:0,duizi:0,longShunzi:0,sanzhang:0,liandui:1,feiji:1},0<(r=6<=(i=this._removeCards(i,e,n)).length?F.addObjects(r,[i[0],i[i.length-1]]):F.addObjects(r,i)).length&&(r=L.splitCardsData(r),r=L.getSortAndDelete(r,1,3,t)),!(0<r.length));a++);if(0>=r.length&&0<e.liandui.length)for(r=[],a=0;a<e.liandui.length&&(i=e.liandui[a],n={dan:0,duizi:0,longShunzi:0,sanzhang:0,liandui:0,feiji:1},0<(r=3<(i=this._removeCards(i,e,n)).length/2?F.addObjects(r,[i[0],i[i.length-1]]):F.addObjects(r,i)).length&&(r=L.splitCardsData(r),r=L.getSortAndDelete(r,1,3,t)),!(0<r.length));a++);return 0>=r.length&&0<e.feiji.length&&(0<(r=F.unpack(e.feiji)).length&&(r=L.splitCardsData(r),r=L.getSortAndDelete(r,1,3,t))),r},getDuiZiTipArray:function(e,t){var r=F.unpack(e.duizi);if(0<r.length&&(r=L.splitCardsData(r),r=F.unpack(this._getCardsSerialTemp(L.getSortAndDelete(r,2,3,t)))),0<e.duizi.length&&0<r.length)for(var n=0;n<e.duizi.length;n++){var a=e.duizi[n];if(2>(a=this._removeObjectByObject(a,F.unpack(e.feiji))).length)r=this._removeObjectByObject(r,e.duizi[n]);else if(2>(a=this._removeObjectByObject(a,F.unpack(e.liandui))).length)r=this._removeObjectByObject(r,e.duizi[n]);else{for(var i=[],u=0;u<e.shunzi.length;u++){var l=this._removeObjectByObject(e.shunzi[u],F.unpack(e.feiji));if(!(3>=l.length||(l=this._removeObjectByObject(e.shunzi[u],F.unpack(e.liandui)),2>=l.length||(l=this._removeObjectByObject(e.shunzi[u],F.unpack(e.duizi)),2>=l.length||(l=e.shunzi[u],a=this._removeObjectByObject(a,l),!(2>a.length)))))){a=e.duizi[n],a=this._removeObjectByObject(a,F.unpack(e.sanzhang));for(var g=!1,h=0;h<e.longShunzi.length;h++){if(!(5>=(o=e.longShunzi[h]).length)){var s=M.tagCard(o[0]).cardValueSuper,o=M.tagCard(o[o.length-1]).cardValueSuper,d=M.tagCard(e.duizi[n][0]).cardValueSuper;if(s==d||o==d){g=!0;break}}}2!=a.length||g||(i.push(l),r=this._removeObjectByObject(r,e.duizi[n]))}}2>(a=this._removeObjectByObject(a,F.unpack(e.sanzhang))).length&&(a=e.duizi[n],2==(a=this._removeObjectByObject(a,F.unpack(i))).length&&(r=this._removeObjectByObject(r,e.duizi[n])))}}if(2<=r.length&&(r=L.splitCardsData(r),r=L.getSortAndDelete(r,2,3,t)),0>=r.length&&0<e.duizi.length&&(r=F.unpack(e.duizi),a={dan:0,duizi:0,longShunzi:0,sanzhang:1,liandui:1,feiji:1},r=this._getArrange(r,e,a,2,t)),0>=r.length&&0<e.sanzhang.length&&(r=F.unpack(e.sanzhang),a={dan:0,duizi:0,longShunzi:0,sanzhang:0,liandui:1,feiji:1},r=this._getArrange(r,e,a,2,t)),0>=r.length&&0<e.liandui.length)for(r=[],n=0;n<e.liandui.length&&(i=e.liandui[n],a={dan:0,duizi:0,longShunzi:0,sanzhang:0,liandui:0,feiji:1},0<(r=3<(i=this._removeCards(i,e,a)).length/2?F.addObjects(r,[i[0],i[1],i[i.length-2],i[i.length-1]]):F.addObjects(r,i)).length&&(r=L.splitCardsData(r),r=L.getSortAndDelete(r,2,3,t)),!(0<r.length));n++);return 0>=r.length&&0<e.feiji.length&&(0<(r=F.unpack(e.feiji)).length&&(r=L.splitCardsData(r),r=L.getSortAndDelete(r,2,3,t))),r},getSanZhangTipArray:function(e,t){var r=F.unpack(e.sanzhang);0<r.length&&(r=L.splitCardsData(r),r=F.unpack(this._getCardsSerialTemp(L.getSortAndDelete(r,3,3,t))));var n={dan:0,duizi:0,longShunzi:1,sanzhang:0,liandui:1,feiji:1};return 0>=(n=this._getArrange(r,e,n,3,t)).length&&(n={dan:0,duizi:0,longShunzi:0,sanzhang:0,liandui:1,feiji:1},n=this._getArrange(r,e,n,3,t)),0>=n.length&&0<e.liandui.length&&(n={dan:0,duizi:0,longShunzi:0,sanzhang:0,liandui:0,feiji:1},n=this._getArrange(r,e,n,3,t)),0>=n.length&&0<e.feiji.length&&(0<(r=F.unpack(e.feiji)).length&&(r=L.splitCardsData(r),n=L.getSortAndDelete(r,3,3,t))),n},getShunZiTipArray:function(e,t){if(0==e.shunzi.length)return[];var r=function(t,r,n){var a=[],i=[];if(0<t.length)for(this._sortTipArr(t,e,n),n=0;n<t.length;n++)t[n].removeCardsNum<r?a.push(t[n]):i.push(t[n]);return{tipTempEnd:a,tipTemp:i}}.bind(this),n=this._screenConformTipArr(e.shunzi,t),a=e.shunzi[0].length,i=r(n,a,{dan:0,duizi:0,shunzi:0,sanzhang:0,liandui:0,feiji:1}),u=r(n=i.tipTemp,a,{dan:0,duizi:0,shunzi:0,sanzhang:0,liandui:1,feiji:0}),l=r(n=u.tipTemp,a,{dan:0,duizi:0,shunzi:0,sanzhang:1,liandui:0,feiji:0});r=r(n=l.tipTemp,a,{dan:0,duizi:1,shunzi:0,sanzhang:0,liandui:0,feiji:0}),n=[],n=F.insertObjects(n,i.tipTempEnd),n=F.insertObjects(n,u.tipTempEnd),n=F.insertObjects(n,l.tipTempEnd),n=F.insertObjects(n,r.tipTempEnd),n=F.insertObjects(n,r.tipTemp);return this._getCardsDataTemp(n)},getLianDuiTipArray:function(e,t){var r=this._screenConformTipArr(e.liandui,t);return this._sortTipArr(r,e,{dan:0,duizi:0,longShunzi:0,sanzhang:1,liandui:0,feiji:1}),this._getCardsDataTemp(r)},getFeiJiTipArray:function(e,t){var r=this._screenConformTipArr(e.feiji,t);return 1<r.length&&this._sortTipArr(r,e,{dan:0,duizi:0,longShunzi:0,sanzhang:0,liandui:1,feiji:0}),this._getCardsDataTemp(r)},isHaveMoreBombA:function(e){var t=M.tagLZOutCard(I.CT_BOMB_FOUR,4,k.Hei_1,[k.Hei_1,k.Hong_1,k.Mei_1,k.Fang_1]),r=[];return 0!=t.OutCardType&&(r=this.getOutCardArray({handCard:e.handCard,lastOutCardInfo:t,isMingPaiRoom:e.isMingPaiRoom,isFriendLianZha:e.isFriendLianZha})),0<r.length},_getAllCardArray:function(e,t,r,n){e=e.concat();var a=L.splitCardsData(e),i={};t=t||[2,3,5];var u=!0,l=8;r!=I.CT_DOUBLE_CONNECT&&r!=I.CT_SINGLE_CONNECT||(u=!1),r==I.CT_SINGLE&&(l=3),r=L.getSortAndDelete(a,3,l);var g=L.getDragon(r,0,t[0]);return i.feiji=this._getCardsSerialTemp(g),n==I.CT_AIRCRAFT||n==I.CT_AIRCRAFT_ONE||n==I.CT_AIRCRAFT_TWO?i:(i.sanzhang=this._getCardsSerialTemp(r),n==I.CT_THREE_LINE_TAKE_ONE||n==I.CT_THREE_LINE_TAKE_TWO||n==I.CT_BOMB_THREE?i:(r=L.getSortAndDelete(a,2,l),g=L.getDragon(r,0,t[1],u),i.liandui=this._getCardsSerialTemp(g),n==I.CT_DOUBLE_CONNECT?i:(i.duizi=this._getCardsSerialTemp(r),n==I.CT_DOUBLE?i:(l=L.getSortAndDelete(a,1,l),u=L.getDragon(l,0,t[2],u),i.longShunzi=this._getCardsSerialTemp(u),t=L.getDragon(l,0,t[2]),i.shunzi=this._getCardsSerialTemp(t),n==I.CT_SINGLE_CONNECT||((n=L.getKingBomb(a))&&2<=n.length&&(e=this._removeObjectByObject(e,n)),L.getSortAndDelete(a,1,3),i.dan=e),i))))},_getAllOutCard:function(e,t,r){for(var n,a=[],i=[],u=!0;u;)0<i.length&&(i=this._getCardsSerialTemp(i),e=this._removeObjectByObject(e,F.unpack(i))),n=this._getAllCardArray(e,null,r),r==I.CT_SINGLE?i=this.getDanPaiTipArray(n,t):r==I.CT_DOUBLE?i=this.getDuiZiTipArray(n,t):r!=I.CT_BOMB_THREE&&r!=I.CT_THREE_LINE_TAKE_ONE&&r!=I.CT_THREE_LINE_TAKE_TWO||(i=this.getSanZhangTipArray(n,t)),0<i.length?a=a.concat(i):u=!1;if(r!=I.CT_SINGLE)for(e=0;e<a.length;e++)((t=a[e])[0].cardSerial==k.King_2||t[0].cardSerial==k.King_1)&&(a.splice(e,1),--e);return a},_getOutCardInfo:function(e,t,r){for(var n=[],a=0;a<e.length;a++){var i=H.getCardsInfo(e[a],null,t,r);n.push(i)}for(t=n.concat(),e=[],a=0;a<t.length;a++)for(r=0;r<t.length;r++){if(a!=r&&t[a].OutCardType==t[r].OutCardType)(i=M.tagCard(t[a].MaxOutCard).cardValueSuper)==M.tagCard(t[r].MaxOutCard).cardValueSuper&&a<r&&e.push(a)}for(t=[],a=0;a<e.length;a++)0>t.indexOf(e[a])&&t.push(e[a]);for(a=e=0;a<t.length;a++)n.splice(t[a]-e,1),e+=1;return n},_getArrange:function(e,t,r,n,a){if(0<(e=this._removeCards(e,t,r)).length){for(t=[],r=0;r<e.length;r++)t.push(e[r]);e=L.splitCardsData(t),e=L.getSortAndDelete(e,n,4,a)}return e},_removeCards:function(e,t,r){return 0<t.feiji.length&&r.feiji&&(e=this._removeObjectByObject(e,F.unpack(t.feiji))),0<t.liandui.length&&r.liandui&&(e=this._removeObjectByObject(e,F.unpack(t.liandui))),0<t.sanzhang.length&&r.sanzhang&&(e=this._removeObjectByObject(e,F.unpack(t.sanzhang))),0<t.longShunzi.length&&r.longShunzi&&(e=this._removeObjectByObject(e,F.unpack(t.longShunzi))),0<t.duizi.length&&r.duizi&&(e=this._removeObjectByObject(e,F.unpack(t.duizi))),e},_getCardsSerialTemp:function(e){for(var t=[],r=0;r<e.length;r++)t.push(L.getCardsSerial(e[r]));return t},_getCardsDataTemp:function(e){for(var t=[],r=0;r<e.length;r++)t.push(L.getCardsData(e[r].cards));return t},_deleteEqual:function(e){for(var t=[],r=0;r<e.length;r++)0>t.indexOf(e[r])&&t.push(e[r]);return t},_removeObjectByObject:function(e,t){var r=[];return t&&e.forEach((function(e){-1===t.indexOf(e)&&r.push(e)})),r},_removeObjectByCardValueSuper:function(e,t){var r,n=[];for(r in e){var a,i=!1;for(a in t)if(M.tagCard(e[r]).cardValueSuper==M.tagCard(t[a]).cardValueSuper){i=!0;break}i||n.push(e[r])}return e},_getChooseLength:function(e,t){var r=void 0;return e==I.CT_DOUBLE_CONNECT?r=[2,t/2,5]:e==I.CT_SINGLE_CONNECT?r=[2,3,t]:e==I.CT_AIRCRAFT_TWO?r=[t/5,2,5]:e==I.CT_AIRCRAFT_ONE?r=[t/4,2,5]:e==I.CT_AIRCRAFT&&(r=[t/3,2,5]),r},_screenConformTipArr:function(e,t){for(var r=e.concat(),n=[],a=0;a<r.length;a++){for(var i=M.tagCard(r[a][0]).cardValueSuper,u=0;u<r[a].length;u++){var l=M.tagCard(r[a][u]).cardValueSuper;i<l&&(i=l)}i>(u=M.tagCard(t).cardValueSuper)&&((i={}).cards=r[a],n.push(i))}return n},_sortTipArr:function(e,t,r,n){n=n||"removeCardsNum",this._addTipArrField(e,t,r,n),this._publicSort(e,n)},_addTipArrField:function(e,t,r,n){for(var a=0;a<e.length;a++){var i=this._removeCards(e[a].cards,t,r);e[a][n]=i.length}},_publicSort:function(e,t){e=e.sort((function(e,r){return r[t]-e[t]}))}},x={isFit:function(e){var t=e.length/3;if(0!=e.length%3)return null;e=L.getCardsData(e),e=L.splitCardsData(e);var r=L.getSortAndDelete(e,3,4);return 1>=r.length?null:(e=r[r.length-1][1].cardSerial,15<=r[r.length-1][1].cardValueSuper||1!=(r=L.getDragon(r,0,t)).length?null:e)}},U={isFit:function(e,t,r){var n=null,a=e.length/5;if(0!=e.length%5||1>=a)return null;if(n=L.getCardsData(e),n=L.splitCardsData(n),1<=L.getBombTab(n,null,t,r).length)return null;if(t=L.getSortAndDelete(n,3,4),1!=(n=L.getDragon(t,0,a)).length)return null;if(n=L.getMax(n[0]).cardSerial,15<=t[t.length-1][1].cardValueSuper)return null;e=L.splitCardsData(e),r=[];for(var i=0;i<t.length;i++){var u=t[i];e=r=e.filter((function(e){for(var t in e)if(e.hasOwnProperty(t))return e[t][0].cardValue!=u[0].cardValue}))}return L.getSortAndDelete(r,2,2).length!=a?null:n}},G={isFit:function(e,t,r){var n=e.length/4;return 0!=e.length%4||1>=n?null:(e=L.getCardsData(e),e=L.splitCardsData(e),1<=L.getBombTab(e,null,t,r).length?null:(t=L.getSortAndDelete(e,3,4),1!=(n=L.getDragon(t,0,n)).length||15<=(n=L.getMax(n[0])).cardValueSuper?null:n.cardSerial))}},W={isFit:function(e,t,r){var n;return n=e.length/5,0!=e.length%5||1>=n?null:(e=L.getCardsData(e),e=L.splitCardsData(e),1<=L.getBombTab(e,null,t,r).length?null:(t=L.getSortAndDelete(e,3,4),1!=(n=L.getDragon(t,0,n)).length?null:(n=L.getMax(n[0]).cardSerial,15<=t[t.length-1][1].cardValueSuper?null:n)))}},P={isFit:function(e){var t=null;return e=L.getCardsData(e),1!=L.splitCardsData(e).length||4>e.length?t:t=e[0].cardSerial}},w={isFit:function(e){var t=null;return 2!=(e=L.getCardsData(e)).length||65==e[0].cardSerial||66==e[0].cardSerial||e[0].cardValueSuper==e[1].cardValueSuper&&(t=e[0].cardSerial),t}},J={isFit:function(e){var t=null;if(e=L.getCardsData(e),L.sortCardsData(e),0!=e.length%2||4>e.length)return t;for(var r=0;r<e.length;r++){var n=e[r+1]&&0==r%2&&e[r].cardValueSuper+1!=e[r+1].cardValueSuper;if(0==r%2&&e[r-1]&&e[r-1].cardValueSuper!=e[r].cardValueSuper||n)return t}return 14<e[e.length-1].cardValueSuper?t:t=e[e.length-1].cardSerial}},Q={isFit:function(e){var t=null;if(e=L.getCardsData(e),L.sortCardsData(e),0!=e.length%2||6>e.length)return t;for(var r=0;r<e.length;r++){var n=e[r+1]&&0==(r+1)%2&&e[r].cardValueSuper+1!=e[r+1].cardValueSuper;if(e[r-1]&&0==(r+1)%2&&e[r-1].cardValueSuper!=e[r].cardValueSuper||n)return t}return 14<e[e.length-1].cardValueSuper?t:t=e[e.length-1].cardSerial}},q={isFit:function(e){return 0}},X={isFit:function(e){var t=null,r=L.getCardsData(e);if(e=L.splitCardsData(r),8!=r.length||3!=e.length)return t;for(var n=r=0;n<e.length;n++){var a,i=e[n];for(a in i)i.hasOwnProperty(a)&&(4==i[a].length&&(t=i[a][0].cardSerial),2==i[a].length&&(r+=1))}return 2!=r?null:t}},Y={isFit:function(e){var t=null;if(7!=(e=L.getCardsData(e)).length)return t;e=L.splitCardsData(e);for(var r=0;r<e.length;r++){var n,a=e[r];for(n in a)if(4==a[n].length){t=a[n][0].cardSerial;break}}return t}},$={isFit:function(e){var t=null,r=L.getCardsData(e);if(e=L.splitCardsData(r),6!=r.length)return t;r=[];for(var n=0;n<e.length;n++){var a,i=e[n];for(a in i)i.hasOwnProperty(a)&&(4==i[a].length&&(t=i[a][0].cardSerial),1==i[a].length&&r.push(i[a][0]))}return 2==r.length&&(65==r[0].cardSerial&&66==r[1].cardSerial||65==r[1].cardSerial&&66==r[0].cardSerial)?null:t}},ee={isFit:function(e){var t=null;return e=L.getCardsData(e),1!=L.splitCardsData(e).length||2!=e.length||e[0].cardSerial!=k.King_1?t:t=e[0].cardSerial}},te={isFit:function(e){var t=null;if(2!=e.length)return t;var r=66==e[0]||66==e[1];return 65!=e[0]&&65!=e[1]||!r?t:t=k.King_2}},re={isFit:function(e){var t=null;return e=L.getCardsData(e),1!=L.splitCardsData(e).length||2!=e.length||e[0].cardSerial!=k.King_2?t:t=e[0].cardSerial}},ne={isFit:function(e){if(e=L.getCardsData(e),2!=L.splitCardsData(e).length||3!=e.length)return null;var t=66==e[0].cardSerial||66==e[1].cardSerial||66==e[2].cardSerial;return 65!=e[0].cardSerial&&65!=e[1].cardSerial&&65!=e[2].cardSerial||!t?null:66}},ae={isFit:function(e){var t=L.getCardsData(e),r=L.splitCardsData(t);return L.sortCardsData(t),2!=r.length||4!=e.length?null:(e=66==t[2].cardSerial&&66==t[3].cardSerial,65==t[0].cardSerial&&65==t[1].cardSerial&&e?66:null)}},ie={isFit:function(e){var t=null;return 1==(e=L.getCardsData(e)).length&&(t=e[0].cardSerial),t}},ue={isFit:function(e){var t=null;if(e=L.getCardsData(e),L.sortCardsData(e),5>e.length)return t;for(var r=1;r<e.length;r++)if(e[r-1].cardValueSuper+1!=e[r].cardValueSuper)return t;return 14<e[e.length-1].cardValueSuper?t:t=e[e.length-1].cardSerial}},le={isFit:function(e){var t=null;return 3!=(e=L.getCardsData(e)).length||e[0].cardValueSuper==e[1].cardValueSuper&&e[1].cardValueSuper==e[2].cardValueSuper&&(t=e[0].cardSerial),t}},ge={isFit:function(e){var t=null,r=L.getCardsData(e);if(e=L.splitCardsData(r),5!=r.length||2!=e.length)return t;for(r=0;r<e.length;r++){var n,a=e[r];for(n in a)if(a.hasOwnProperty(n)&&(3==a[n].length&&(t=a[n][0].cardSerial),1==a[n].length)){t=null;break}}return t}},he={isFit:function(e){var t=null,r=L.getCardsData(e);r=L.splitCardsData(r);if(4!=e.length||2!=r.length)return t;for(e=0;e<r.length;e++){var n,a=r[e];for(n in a)if(a.hasOwnProperty(n)&&3==a[n].length){t=a[n][0].cardSerial;break}}return t}},se={isFit:function(e){var t=null;if(5!=(e=L.getCardsData(e)).length)return t;e=L.splitCardsData(e);for(var r=0;r<e.length;r++){var n,a=e[r];for(n in a)if(a.hasOwnProperty(n)&&3==a[n].length){t=a[n][0].cardSerial;break}}return t}};module.exports={HALLWorker:e,DDZHArrayEx:t,DDZHCard:r,DDZHCardColor:n,DDZHCardType:a,DDZHTools:i,DDZHRule:u,DDZHRuleHelper:l,DDZHRuleRegister:g,DDZHTipCard:h,DDZHRuleAir:s,DDZHRuleAirTakeDouble:o,DDZHRuleAirTakeOne:d,DDZHRuleAirTakeTwo:c,DDZHRuleBomb:f,DDZHRuleDouble:C,DDZHRuleDoubleDragon:_,DDZHRuleDoubleDragonTMore:p,DDZHRuleError:O,DDZHRuleFourTakeDoubleTwo:T,DDZHRuleFourTakeThree:S,DDZHRuleFourTakeTwo:v,DDZHRuleKingBomb:D,DDZHRuleLineBombFive:b,DDZHRuleLineBombFour:j,DDZHRuleLineBombThree:B,DDZHRuleLineBombTwo:A,DDZHRuleOne:m,DDZHRuleOneDragon:E,DDZHRuleThree:z,DDZHRuleThreeTakeDouble:V,DDZHRuleThreeTakeOne:y,DDZHRuleThreeTakeTwo:R,VSDZArrayEx:F,VSDZCard:k,VSDZCardColor:N,VSDZCardType:I,VSDZTools:M,VSDZRule:L,VSDZRuleHelper:H,VSDZRuleRegister:Z,VSDZTipCard:K,VSDZRuleAir:x,VSDZRuleAirTakeDouble:U,VSDZRuleAirTakeOne:G,VSDZRuleAirTakeTwo:W,VSDZRuleBomb:P,VSDZRuleDouble:w,VSDZRuleDoubleDragon:J,VSDZRuleDoubleDragonTMore:Q,VSDZRuleError:q,VSDZRuleFourTakeDoubleTwo:X,VSDZRuleFourTakeThree:Y,VSDZRuleFourTakeTwo:$,VSDZRuleKingBomb1:ee,VSDZRuleKingBomb2:te,VSDZRuleKingBomb3:re,VSDZRuleKingBomb4:ne,VSDZRuleKingBomb5:ae,VSDZRuleOne:ie,VSDZRuleOneDragon:ue,VSDZRuleThree:le,VSDZRuleThreeTakeDouble:ge,VSDZRuleThreeTakeOne:he,VSDZRuleThreeTakeTwo:se}; 
 			});
 		define("workers/work_client.js", function(require, module, exports, window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){ 			
"use strict";console.log("worker started");var e=require("./games_exports"),r=e.HALLWorker;worker.postMessage({msg:"WorkerStarted"}),worker.onMessage((function(o){var s=o.module,a=o.function,l=o.args,t=e[s],g=t[a];console.log("WorkerInvokeReceived:",s,a);var c=g.call(t,l);worker.postMessage({call_id:o.call_id,result:c,log:r.getWorkerLog()})})); 
 			});
 	